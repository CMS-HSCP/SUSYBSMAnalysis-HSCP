

//TEST

#include <vector>

#include "TROOT.h"
#include "TFile.h"
#include "TDirectory.h"
#include "TChain.h"
#include "TObject.h"
#include "TCanvas.h"
#include "TMath.h"
#include "TLegend.h"
#include "TGraph.h"
#include "TH1.h"
#include "TH2.h"
#include "TH3.h"
#include "TTree.h"
#include "TF1.h"
#include "THStack.h"
#include "TGraphErrors.h"
#include "TGraphAsymmErrors.h"
#include "TPaveText.h"
#include "tdrstyle.C"
#include "TCutG.h"
#include "TProfile.h"

#include "../../AnalysisCode/Analysis_PlotFunction.h"
#include "../../AnalysisCode/Analysis_Samples.h"
//#include "../../AnalysisCode/Analysis_Step4_LimitComputation.C"

//#include "roostats_cl95.C"



int ExcludedBySUS12030[] = {179385, 180012, 180476, 181451, 181871, 182156, 182801, 182915, 183218, 184008, 184226, 184439, 184632, 184866, 185694, 185893, 187066, 187329, 187439, 187623, 190038, 190467, 190646, 190989, 191132, 191134, 191252, 191436, 191455, 191825, 192091, 192311, 192362, 192615, 193091, 193786, 193821, 193829, 194517, 194671, 195330, 195390, 195681, 195821, 195926, 196168, 196174, 196328, 196740, 197072, 197312, 197745, 197892, 197993, 198467, 199204, 199395, 199406, 199426, 199932, 200892, 201098, 201348, 201377, 201803, 201812, 201969, 202449, 202449, 202567, 202745, 203038, 203128, 203326, 203746, 203898, 203942, 204022, 204268, 204412, 204804, 204822, 205469, 205900, 206136, 207140, 207433, 207704, 207873, 209155, 209183, 209240, 209306, 210112, 210114, 210267, 210373, 211250, 211374, 211446, 211455, 211970, 212195, 213204, 213374, 213429, 214090, 214298, 215379, 215391, 215717, 215758, 216620, 217485, 218581, 218750, 219012, 219176, 219344, 219712, 219818, 220020, 220110, 220386, 221045, 221473, 222222, 222273, 222419, 222442, 222759, 222773, 223011, 223630, 223770, 223865, 224142, 224491, 224751, 224755, 224908, 224966, 224972, 225099, 225367, 225396, 225419, 225533, 225674, 226284, 226525, 226656, 227199, 227875, 227877, 228668, 229835, 229917, 230084, 230256, 230372, 230403, 231268, 231739, 231850, 231861, 232235, 232337, 233165, 233242, 233494, 234530, 234679, 234940, 235074, 235283, 235352, 235986, 236296, 236393, 236927, 236944, 237275, 237942, 238115, 238152, 238195, 238272, 238302, 238304, 238478, 239358, 239668, 239733, 239949, 240201, 240258, 240513, 240802, 240915, 241135, 241297, 241481, 241522, 241545, 241742, 241927, 241954, 241979, 242422, 242928, 243152, 243199, 243552, 243603, 243689, 243912, 243922, 244441, 244531, 244925, 245070, 245314, 246486, 246828, 247003, 247516, 247938, 248078, 248505, 248510, 249032, 249095, 249256, 249335, 249807, 249826, 250283, 250802, 251291, 252155, 252338, 252474, 252533, 252728, 252933, 253167, 253410, 253596, 253599, 253617, 253670, 253935, 254119, 254137, 254560, 254620, 254970, 254972, 255631, 255712, 256855, 256954, 257037, 257294, 257364, 257402, 258391, 259108, 259261, 259275, 259382, 259650, 259842, 259889, 259954, 260348, 260354, 260509, 260676, 260860, 260936, 261145, 261893, 262510, 263725, 263745, 263811, 263841, 263843, 264227, 265395, 265487, 265687, 265908, 266085, 266198, 266448, 266528, 266993, 267021, 268044, 269198, 269437, 269453, 269475, 269519, 269699, 269809, 269909, 270168, 270274, 270567, 270611, 271811, 271978, 272153, 272193, 272235, 272316, 272541, 272956, 273161, 273202, 273948, 274308, 274417, 274488, 274703, 274839, 274945, 274946, 275050, 275122, 275895, 276347, 276461, 276721, 276953, 277348, 277359, 277909, 278242, 278420, 279042, 279174, 279463, 279756, 279953, 280654, 280936, 281693, 282212, 282728, 283419, 283462, 283497, 283638, 284202, 284351, 284429, 284506, 284569, 284678, 284745, 284992, 285037, 285094, 285101, 285383, 285571, 285595, 285857, 287086, 287972, 288006, 288031, 288183, 288755, 289211, 289694, 290005, 290031, 290670, 291195, 291598, 292592, 292971, 293122, 293257, 293330, 293702, 294057, 294151, 294165, 294451, 294693, 294789, 294895, 294917, 295260, 295471, 296577, 296591, 296745, 296947, 296952, 297059, 297061, 297439, 298053, 298348, 298398, 298455, 298456, 299416, 299769, 299815, 300118, 300630, 300702, 300778, 302112, 302375, 302663, 302969, 303024, 303222, 303589, 303601, 304042, 304103, 304407, 304484, 304602, 305106, 305197, 305366, 305445, 305871, 306798, 307626, 307872, 307951, 308418, 308427, 308700, 308732, 308817, 309227, 309237, 309339, 309375, 309414, 309625, 309700, 309709, 309718, 309887, 310698, 310790, 310991, 311189, 311926, 312626, 312701, 312936, 313053, 314181, 314292, 314402, 314669, 314670, 315663, 315770, 316198, 316442, 316461, 316821, 316900, 317521, 317896, 318276, 318856, 319068, 319133, 319765, 319791, 320060, 320105, 320154, 320172, 321441, 322107, 322283, 322489, 322877, 323413, 324057, 324581, 325205, 325360, 325403, 325981, 326002, 326115, 326688, 326913, 327024, 327075, 327956, 328174, 328678, 330297, 330358, 331427, 332205, 332765, 333061, 333346, 333371, 333658, 334377, 334862, 336014, 336487, 337023, 337800, 339192, 339270, 339291, 339407, 339708, 339883, 340308, 340400, 340899, 341541, 342282, 342440, 342867, 342959, 343081, 343202, 343536, 343739, 343809, 344487, 345219, 346158, 346461, 347310, 347334, 347423, 347503, 347652, 347940, 349045, 349733, 349983, 350004, 350124, 350349, 350380, 350786, 350881, 350961, 351704, 351710, 351811, 352304, 352557, 352756, 352758, 352960, 353382, 353645, 354257, 354268, 354363, 354409, 354682, 355002, 355490, 355546, 355681, 356049, 356073, 356121, 356262, 356443, 356473, 356629, 356645, 356747, 356803, 356815, 357139, 357499, 357664, 357940, 358065, 358206, 358717, 359034, 359424, 359562, 359567, 359777, 360162, 360265, 360859, 360921, 361030, 361140, 361406, 362061, 362835, 362954, 363010, 363057, 363524, 363605, 363627, 363806, 363915, 364144, 364458, 364665, 364831, 365124, 365619, 366403, 366518, 366883, 366980, 367151, 367153, 368386, 368453, 369046, 369316, 369462, 369980, 370644, 371505, 372120, 372991, 373231, 373403, 373757, 374206, 374410, 374988, 375647, 376035, 376122, 376435, 377096, 377779, 377967, 378101, 378516, 378591, 378876, 378939, 379044, 379641, 380214, 380238, 381478, 382426, 382807, 383238, 383593, 383748, 384068, 384097, 384448, 384485, 384770, 384836, 385356, 385809, 385850, 386193, 386320, 387234, 387566, 388131, 388147, 388444, 388510, 389216, 389229, 389956, 391219, 391778, 391831, 392606, 392702, 393194, 393555, 394293, 394524, 394573, 394763, 395265, 395406, 395514, 395630, 395927, 396576, 396855, 397171, 397239, 397436, 397781, 397880, 398105, 398146, 398559, 399445, 399672, 400052, 400234, 400799, 401119, 401242, 401299, 401903, 402415, 402721, 402961, 403871, 404307, 404982, 405011, 405132, 406171, 406324, 406480, 406496, 406523, 406625, 406811, 406875, 406993, 407552, 407608, 408136, 408298, 408326, 408365, 408456, 408605, 408628, 408873, 408908, 409416, 409521, 409622, 410797, 411093, 411806, 411955, 412565, 412621, 412701, 412753, 413198, 413630, 413765, 413817, 413949, 414605, 414657, 415125, 415228, 415429, 416237, 416278, 416553, 416932, 417355, 417615, 417995, 418468, 418741, 418883, 419025, 419254, 419870, 420892, 420918, 421119, 421365, 421439, 421841, 421882, 422180, 422286, 423150, 423705, 423923, 424005, 424651, 425019, 425155, 425181, 426054, 426322, 426616, 427150, 427777, 428306, 429111, 429286, 429408, 429637, 429710, 430123, 430640, 431307, 431313, 431559, 432041, 432181, 434381, 434437, 434557, 435007, 435062, 435157, 435364, 435448, 435485, 435723, 435871, 436202, 436845, 436900, 437009, 437440, 437670, 438192, 438424, 438676, 439327, 440013, 440158, 440244, 440355, 440515, 440677, 441211, 441409, 441486, 441582, 441742, 441998, 442493, 443308, 443604, 444278, 444571, 444845, 444995, 445277, 445525, 445589, 445745, 446016, 446039, 446092, 446153, 446275, 446297, 446598, 446776, 446778, 446872, 447857, 448333, 448528, 448543, 448588, 448695, 448724, 449500, 449792, 449969, 450295, 450605, 450634, 451301, 451442, 452797, 453746, 453749, 454598, 454872, 455029, 455547, 455965, 456042, 456395, 456703, 456724, 457429, 457441, 457500, 457593, 457681, 457837, 457877, 457961, 457993, 458182, 458743, 458833, 459069, 459121, 459145, 459414, 459505, 459847, 459873, 460327, 460591, 461648, 462240, 462502, 462576, 462628, 462696, 462930, 463064, 463366, 463565, 463699, 463893, 463954, 464062, 464649, 464825, 464866, 465095, 466030, 466063, 466807, 467094, 467775, 467842, 467862, 467878, 468022, 468023, 468180, 468845, 469207, 470171, 470181, 470601, 470680, 470710, 471051, 471958, 472005, 472731, 472802, 472892, 473442, 473448, 473605, 473771, 474739, 474772, 474893, 475212, 475229, 475618, 475762, 475920, 476115, 476138, 476541, 476729, 476998, 477035, 477431, 477471, 477482, 477633, 477741, 478575, 478890, 479004, 479284, 479364, 479648, 479873, 480266, 481341, 481362, 482074, 482260, 482371, 482457, 482650, 482860, 483091, 483162, 483194, 483359, 484688, 484946, 485037, 485358, 485490, 485867, 486772, 486801, 487248, 487313, 487985, 488178, 488610, 488643, 489532, 490127, 490224, 490284, 490402, 491468, 491699, 491876, 491884, 491944, 492002, 492142, 492203, 492210, 492657, 493319, 493496, 493863, 494482, 495108, 495115, 495384, 495566, 495637, 496119, 496227, 496288, 496326, 496371, 497899, 498116, 498356, 498642, 499160, 499293, 499353, 499505, 499778, 500074, 500110, 500265, 500309, 500369, 500508, 500893, 500946, 500983, 501040, 501150, 501417, 501596, 501718, 501803, 501939, 502469, 502548, 502588, 502601, 502896, 503642, 503908, 504076, 504468, 505021, 505086, 505578, 505793, 505811, 505916, 505930, 506496, 506891, 507292, 508887, 509276, 509306, 509960, 510569, 511117, 511854, 512286, 512314, 512486, 512521, 512758, 513808, 514742, 515047, 515059, 515076, 515635, 515674, 515698, 515953, 516233, 516336, 516512, 516783, 516912, 516948, 517391, 517932, 518492, 518676, 518797, 518855, 518883, 519319, 521150, 521493, 522082, 522147, 522335, 522729, 523432, 523989, 524073, 524352, 524783, 524987, 525637, 525869, 526002, 526047, 526077, 526371, 526878, 526980, 527806, 528124, 528282, 529004, 529153, 529459, 529714, 530206, 530574, 531068, 531243, 531260, 531596, 532029, 532492, 532800, 533125, 533439, 533886, 534509, 534930, 535197, 535292, 535390, 535417, 535589, 535707, 536135, 536688, 537234, 537271, 537539, 538237, 538499, 538708, 538851, 538925, 540055, 540195, 540496, 540639, 540654, 541109, 541372, 541498, 541635, 541705, 542006, 542351, 542439, 542533, 542609, 542732, 543462, 543553, 543619, 544291, 545042, 545442, 545489, 545710, 545800, 545843, 546030, 546884, 546991, 548050, 548127, 548134, 548416, 548456, 549099, 549298, 549410, 549444, 550635, 550757, 551065, 551176, 551586, 551779, 552165, 552296, 552623, 553052, 553711, 553793, 553887, 555026, 555030, 555078, 555885, 556074, 556176, 556488, 557032, 557043, 557694, 557731, 558581, 558812, 558984, 559022, 559564, 560019, 560185, 560213, 560285, 561057, 561219, 561284, 561741, 561852, 562172, 562190, 562325, 563308, 564047, 564215, 564609, 564698, 564786, 564821, 565245, 565720, 565927, 566007, 566226, 566475, 566655, 566734, 566824, 566847, 567199, 567256, 567815, 567868, 568159, 568288, 569054, 569278, 569621, 569910, 570093, 570143, 570175, 570567, 571420, 572164, 572883, 573032, 573261, 573391, 573941, 574206, 574249, 574446, 574522, 574841, 575192, 575912, 576359, 577391, 578096, 578502, 579159, 579172, 579431, 580191, 580497, 580594, 580934, 581148, 581634, 581701, 582151, 582207, 582337, 582763, 583544, 584452, 585622, 585730, 585860, 586096, 586147, 586151, 586226, 586329, 586409, 586763, 586958, 587235, 587327, 587485, 588187, 589041, 589097, 589235, 589597, 589612, 589951, 590000, 590284, 591132, 591208, 591238, 591266, 591345, 591364, 591464, 591522, 591757, 591758, 592324, 592529, 593878, 594322, 594421, 594598, 594994, 595253, 595290, 596160, 596662, 596694, 597018, 598384, 598600, 598904, 599067, 599187, 599286, 599418, 599559, 599760, 600087, 600534, 600622, 600707, 600849, 602191, 602345, 602758, 603174, 603216, 603279, 603557, 603709, 604424, 605609, 606012, 607006, 607366, 607371, 607453, 608189, 608372, 608617, 608739, 609104, 609550, 609670, 609877, 610123, 610289, 611459, 611883, 612259, 612406, 612504, 613152, 613251, 613596, 614162, 614360, 614435, 615349, 615471, 615764, 615861, 616201, 616272, 616797, 616983, 617292, 617342, 617681, 618144, 618214, 618596, 618610, 618958, 619202, 619468, 619534, 620097, 620646, 620803, 620875, 620935, 621940, 622134, 622278, 622877, 623201, 623260, 623461, 623595, 623785, 623881, 624112, 624420, 625178, 625405, 626263, 626288, 626491, 627086, 627481, 627854, 628098, 628192, 628518, 628645, 628772, 629535, 629972, 629980, 630320, 631449, 632204, 632348, 632564, 632995, 634056, 634428, 635636, 637524, 637543, 637829, 638307, 638634, 638781, 639059, 639138, 639553, 639613, 640089, 640111, 640217, 640845, 640888, 640955, 642534, 642775, 643196, 643514, 643712, 643812, 644041, 644285, 645351, 645963, 646256, 646509, 646584, 646661, 646674, 647047, 647077, 647661, 647758, 648022, 648127, 648184, 648519, 648747, 648755, 650084, 650290, 650439, 650443, 650587, 650636, 650711, 651414, 651691, 651814, 652004, 652173, 652388, 652503, 652506, 652616, 652703, 652756, 653188, 653405, 653597, 653776, 653828, 654153, 654168, 654826, 655269, 655928, 656328, 656384, 656675, 657129, 657573, 658264, 658336, 658523, 658802, 659350, 659817, 659840, 659938, 660377, 660728, 660801, 660953, 661084, 661412, 661428, 661718, 662164, 662366, 662493, 662606, 662956, 663127, 664241, 664618, 664755, 664999, 665267, 665477, 665640, 665881, 665923, 666166, 666215, 666894, 667283, 667317, 667370, 667999, 668041, 668186, 668845, 669055, 669139, 669411, 669451, 670306, 670342, 670354, 670509, 670989, 671075, 671155, 671436, 671843, 671880, 672048, 673211, 673298, 673363, 673418, 673763, 674174, 674209, 674689, 674693, 675622, 675977, 675983, 676882, 677198, 678240, 678568, 678944, 680036, 680056, 680526, 681318, 681837, 681952, 682199, 683006, 683033, 683441, 683745, 683873, 684092, 684309, 684369, 684583, 684887, 684936, 685226, 685588, 685876, 686041, 686584, 687200, 687280, 689840, 689841, 689876, 690182, 690518, 690750, 690813, 690898, 690988, 691651, 691940, 691963, 692063, 692408, 692660, 693286, 693392, 694410, 695551, 695658, 695772, 695935, 696055, 696175, 696284, 696690, 696887, 697055, 697320, 697742, 697770, 697773, 697799, 698105, 698150, 698659, 698695, 699225, 699574, 700071, 700240, 700494, 701132, 701350, 701356, 701382, 701474, 701583, 701639, 702199, 702394, 702606, 702771, 702875, 703373, 703598, 703700, 704226, 704802, 704807, 704940, 706058, 706097, 706704, 707176, 707202, 707286, 707352, 707498, 707689, 707916, 707926, 708891, 709135, 709472, 709489, 709850, 709868, 710620, 710975, 712587, 712749, 712751, 712804, 712922, 713139, 713287, 713344, 713523, 713745, 714971, 715047, 715572, 716058, 716388, 716397, 716397, 716612, 716741, 717040, 717049, 717610, 717630, 717826, 717858, 717862, 717928, 718196, 719167, 719757, 719769, 719778, 720045, 720250, 720339, 720355, 720405, 720568, 720678, 721170, 721305, 721319, 721631, 721845, 722089, 722274, 722452, 723385, 724206, 724729, 725093, 725249, 726170, 726173, 726238, 727064, 727291, 727654, 728558, 728740, 728948, 729719, 729830, 730446, 731068, 731255, 731256, 731405, 731481, 731842, 731864, 732285, 733869, 734014, 734247, 734428, 734778, 734906, 735194, 735324, 735397, 735417, 735491, 735564, 735640, 736402, 737092, 737824, 737883, 737905, 738878, 739137, 739471, 739835, 740167, 740201, 740400, 740429, 740612, 740716, 740782, 740874, 740959, 741546, 741869, 742522, 742670, 742835, 742949, 743194, 743748, 744480, 745091, 745317, 745698, 745906, 746096, 746408, 746648, 746806, 747338, 747589, 747596, 748150, 748738, 748775, 748849, 748859, 748935, 751082, 751293, 751633, 751768, 752405, 753037, 753468, 753870, 754553, 754680, 754830, 754897, 755718, 755769, 756234, 756608, 756705, 756731, 756845, 756908, 756953, 757196, 758153, 758564, 758992, 759274, 759860, 760259, 760417, 760513, 760534, 760611, 760788, 761154, 761560, 761827, 762517, 762600, 762668, 762755, 762809, 763053, 763093, 763432, 763910, 764082, 764112, 764202, 764488, 764523, 765176, 765387, 765680, 765939, 766275, 766377, 766444, 766581, 766793, 766854, 766989, 767488, 768055, 768258, 768533, 769945, 770504, 770610, 770958, 771231, 771290, 771485, 771793, 772103, 772425, 772507, 772645, 772813, 774475, 776289, 777109, 777297, 777564, 777740, 778449, 778866, 778938, 779103, 779479, 780336, 780712, 781403, 781553, 782054, 782197, 782402, 783586, 783746, 783932, 784085, 784235, 784348, 784764, 784779, 785087, 785362, 785450, 785621, 785661, 786259, 786565, 786667, 787033, 787177, 787369, 787519, 788613, 788695, 788764, 789785, 789883, 789932, 790207, 790409, 790561, 790721, 790997, 791095, 791514, 791596, 791814, 792802, 793759, 794096, 794100, 794112, 794508, 795161, 795559, 796231, 796368, 796659, 797033, 797258, 797263, 798814, 799107, 799228, 799228, 799257, 799319, 799415, 800058, 800676, 801151, 801338, 801548, 802794, 803057, 803066, 803263, 803887, 804300, 804465, 804626, 804670, 805224, 805317, 805328, 805428, 805621, 805703, 805711, 805728, 805906, 806333, 806903, 807534, 807678, 808390, 808409, 808598, 808626, 808722, 809415, 809984, 810050, 810054, 810394, 810759, 810761, 810777, 811504, 811626, 811939, 812101, 812125, 812320, 812662, 813569, 814561, 814792, 814852, 814854, 815407, 816293, 817190, 817852, 818108, 818566, 818577, 818758, 818903, 820176, 820612, 821195, 822041, 822054, 822573, 822603, 823279, 823281, 823627, 823807, 823807, 824044, 824096, 824120, 824321, 824473, 826146, 826644, 826756, 827379, 827430, 827500, 827624, 828024, 828117, 828175, 828828, 829148, 829189, 829512, 829643, 830022, 830528, 830555, 830652, 830743, 830762, 831030, 831304, 831467, 832418, 832690, 832791, 832881, 832891, 832941, 833135, 833222, 833639, 834348, 834761, 834963, 835233, 835867, 836042, 836253, 836429, 836623, 836862, 836978, 836990, 837023, 837409, 837742, 838685, 838733, 838955, 839038, 839184, 839346, 839447, 839799, 840179, 840518, 840908, 840913, 841240, 841318, 841333, 841451, 841579, 841786, 841992, 842087, 842137, 843157, 844044, 844138, 844450, 844558, 844656, 844893, 844916, 845264, 846614, 847065, 847349, 847564, 848233, 848851, 849250, 849821, 850319, 850627, 850834, 850942, 852011, 852260, 852652, 852736, 853016, 853234, 853586, 853916, 855091, 855313, 855472, 855497, 855730, 856229, 856400, 856576, 856632, 856755, 856844, 857714, 858241, 858249, 858319, 858656, 858716, 859261, 859821, 859910, 860240, 860243, 860247, 860745, 860952, 861205, 861383, 861386, 861609, 861679, 861848, 862056, 862533, 862659, 862677, 862719, 863266, 863372, 863543, 863669, 864401, 864461, 864592, 864687, 864752, 864798, 865365, 865644, 865830, 866175, 866313, 866971, 867380, 867839, 867849, 868038, 868143, 868205, 868366, 868693, 868936, 869277, 869458, 869730, 869881, 870879, 870998, 871367, 871843, 871976, 872437, 872514, 872527, 872886, 873573, 873697, 873808, 873897, 873926, 874420, 874473, 874771, 875229, 876173, 876318, 876596, 876802, 877333, 877695, 879089, 879158, 879289, 880140, 880590, 880625, 880793, 880829, 881785, 881867, 881945, 882317, 882630, 883079, 883667, 883688, 883872, 883882, 884556, 884576, 884610, 884840, 884911, 884936, 884957, 885177, 885792, 885944, 886106, 886166, 886528, 886557, 886709, 887074, 887429, 887558, 887759, 888716, 888916, 888945, 889447, 890451, 890729, 891461, 891577, 891690, 891789, 891800, 892014, 892066, 893904, 894126, 894293, 894833, 895193, 895548, 895634, 895679, 896012, 896214, 896291, 896723, 897276, 897353, 897369, 897413, 897565, 897754, 897953, 898419, 899027, 899167, 899451, 899465, 900396, 901283, 901548, 901571, 902394, 902577, 902736, 903294, 903364, 903434, 903946, 904069, 904542, 904638, 904798, 904916, 905860, 906127, 906144, 906155, 906710, 906768, 906997, 907654, 907659, 907876, 907882, 908131, 908366, 908541, 911387, 911640, 912318, 912372, 912745, 912772, 913251, 913755, 913952, 914186, 914270, 914495, 914580, 914764, 914835, 915394, 915438, 915686, 915772, 915838, 915842, 916852, 916942, 916996, 917662, 917758, 918300, 918528, 918889, 918990, 919029, 919118, 919677, 919816, 920053, 920271, 920291, 920428, 921238, 922384, 922767, 923173, 923211, 923321, 923527, 923568, 923739, 923765, 924096, 924109, 924172, 924227, 925303, 926317, 926329, 926336, 927008, 927177, 928015, 928802, 928868, 929277, 929959, 930410, 930940, 931473, 932199, 932669, 932867, 932924, 932946, 933111, 933326, 933590, 933870, 933926, 933954, 934051, 934329, 934658, 934698, 935120, 935151, 935154, 935705, 936361, 936621, 936811, 937225, 938179, 938184, 938368, 938554, 938998, 939014, 939617, 939676, 939992, 940215, 940304, 940383, 940434, 940482, 940544, 941506, 942928, 942966, 943044, 943224, 943234, 943265, 943413, 943575, 943632, 943741, 943857, 943919, 944395, 944426, 945074, 945148, 945169, 945857, 945871, 946019, 946291, 946302, 946491, 946827, 946883, 947340, 947929, 948093, 948100, 948527, 948766, 949692, 949720, 949898, 950798, 950810, 951139, 951351, 952557, 953242, 953407, 953435, 953598, 953862, 954362, 954555, 954996, 955384, 955576, 956101, 956164, 956672, 956699, 956909, 957239, 957289, 957376, 957531, 957909, 957944, 958523, 958843, 958992, 959513, 959856, 960310, 960593, 960871, 960872, 961286, 961398, 961419, 961641, 961693, 962190, 962873, 963092, 963585, 963617, 964672, 965177, 965549, 965976, 966109, 966405, 967257, 967445, 967592, 967703, 967951, 968447, 968544, 968713, 968836, 969277, 969363, 969371, 969938, 970078, 970104, 970217, 970376, 970415, 970508, 970746, 971192, 971468, 971718, 972471, 972558, 972620, 972687, 973078, 973109, 973166, 973523, 974025, 974408, 974452, 974487, 974672, 975068, 975582, 975949, 976427, 976467, 976468, 976670, 976958, 977415, 977621, 977742, 977857, 978617, 978776, 978948, 978958, 979359, 979451, 979708, 979743, 980006, 980050, 980328, 980377, 980632, 981575, 982102, 982255, 983079, 983191, 983319, 983711, 984524, 984969, 985372, 985894, 986096, 986110, 986362, 986569, 986668, 987633, 987987, 988770, 989016, 989178, 989219, 989463, 989988, 990412, 990470, 991063, 991102, 991173, 992231, 993076, 993447, 993585, 993616, 993925, 994070, 994953, 994969, 995253, 995282, 996003, 996280, 996454, 996642, 997352, 998406, 998455, 998464, 998764, 998965, 999480, 999724, 999797}; 



struct dataModel{string Name; double mass; double massCut; double TEff; double TEffErr; double PEff; double PEffErr; double OEff; double OEffErr; double Limits[6]; double ThXSec; double width;};


std::vector<dataModel> readFromFile(string fileName, double mass_, double width_=-1){
   std::vector<dataModel> dms;
   FILE* pFile=fopen(fileName.c_str(), "r");
   if(!pFile){printf("%s does not exist\n", fileName.c_str()); return dms; }
   char line[4096];

//    double SF = 1.0;
//         if(Pred==44.0 ){SF = 0.95; } // SF = Hybrid/Asymptotic  M>0
//    else if(Pred== 5.6 ){SF = 1.07; } // SF = Hybrid/Asymptotic  M>100
//    else if(Pred== 0.56){SF = 1.38; } // SF = Hybrid/Asymptotic  M>200
//    else if(Pred== 0.02){SF = 2.00; } // SF = Hybrid/Asymptotic  M>300
//    else{printf("ERROR SF CANNOT BE COMPUTED.... YOU SHOULD USE FULL HYBRID LIMITS\n");}

   while(fgets(line, 4096, pFile)){
      char NameBuffer[256];  dataModel dm;
      sscanf(line, "%s M>%lf Efficiencies: Trigger=%lf%%+-%lf%%  Presel=%lf%%+-%lf%% Offline=%lf%%+-%lf%%  Limits=%lf %lf %lf %lf %lf %lf  ThXSec=%lf", NameBuffer, &dm.massCut, &dm.TEff, &dm.TEffErr, &dm.PEff, &dm.PEffErr, &dm.OEff, &dm.OEffErr, &dm.Limits[0], &dm.Limits[1], &dm.Limits[2], &dm.Limits[3], &dm.Limits[4], &dm.Limits[5], &dm.ThXSec);
//      //apply correction factor from Asymptotic to FullHybridLimits
           if(dm.massCut<=  0){ for(int i =0;i<6;i++){dm.Limits[i]*= 0.95;} }
      else if(dm.massCut<=100){ for(int i =0;i<6;i++){dm.Limits[i]*= 1.07;} }
      else if(dm.massCut<=200){ for(int i =0;i<6;i++){dm.Limits[i]*= 1.68;} } //1.38
      else if(dm.massCut<=300){ for(int i =0;i<6;i++){dm.Limits[i]*= 1.95;} } //2.0
      else if(dm.massCut<=400){ for(int i =0;i<6;i++){dm.Limits[i]*= 1.95;} }
      else if(dm.massCut<=500){ for(int i =0;i<6;i++){dm.Limits[i]*= 1.95;} }
      dm.Name = NameBuffer; dm.mass = mass_;  dm.width = width_;
      dms.push_back(dm);
   }
   fclose(pFile);
   return dms;
}

TGraphErrors* MakePlot(int DrawIndex, std::vector< std::vector<dataModel> >& dmsVector){
   unsigned int N   = dmsVector.size();
   double* Xval     = new double   [N];
   double* Xerr     = new double   [N];
   double* Yval     = new double   [N];
   double* Yerr     = new double   [N];
   char YAxisTitle[256];
   bool PlotVsWidth=(dmsVector[0][0].width!=-1);
   for(unsigned int i=0;i<N;i++){
//      Xval[i] = PlotVsWidth ? log10(299792458 * 6.58211928E-25 / dmsVector[i][0].width) : dmsVector[i][0].mass;
      Xval[i] = PlotVsWidth ? log10(dmsVector[i][0].width) : dmsVector[i][0].mass;
      Xerr[i] = 0;
      switch(DrawIndex){
         case -2:
         Yval[i] = dmsVector[i][0].TEff;
         Yerr[i] = dmsVector[i][0].TEffErr;
//         if(Yval[i]<=0 || Yval[i]-Yerr[i]){Yval[i]=1E-5; Yerr[i]=0;}
         if(i==0)sprintf(YAxisTitle,"Acceptance (%%) at Trigger");
         break;
         case -1:
         Yval[i] = dmsVector[i][0].PEff;
         Yerr[i] = dmsVector[i][0].PEffErr;
//         if(Yval[i]<=0 || Yval[i]-Yerr[i]){Yval[i]=1E-5; Yerr[i]=0;}
         if(i==0)sprintf(YAxisTitle,"Acceptance (%%) at PreSelection");
         break;
         default:
         Yval[i] = dmsVector[i][DrawIndex].OEff;
         Yerr[i] = dmsVector[i][DrawIndex].OEffErr;
//         if(Yval[i]<=0 || Yval[i]-Yerr[i]){Yval[i]=1E-5; Yerr[i]=0;}
         if(i==0)sprintf(YAxisTitle,"Acceptance (%%) for M#kern[-0.1]{_{req}}= %i GeV/c#kern[-0.0]{^{2}}",(int)dmsVector[i][DrawIndex].massCut);
         break;
      }
   }
   double Ymin=1E100; double Ymax=-1E100; for(unsigned int i=0;i<N;i++){Ymin=std::min(Ymin, Yval[i]-Yerr[i]); Ymax=std::max(Ymax, Yval[i]+Yerr[i]);}
   Ymin=std::max(Ymin, 0.0);
   Ymax=std::max(Ymax, 0.0);
   printf("YMIN YMAX = %f - %f\n", Ymin, Ymax);
   TGraphErrors* graph = new TGraphErrors(N,Xval,Yval, Xerr, Yerr);
   graph->SetTitle("");
   graph->SetMinimum(0.9*Ymin);
   graph->SetMaximum(1.15*Ymax);
   graph->GetXaxis()->SetTitle(PlotVsWidth ? "log_{10} [ #chi_{1}^{#pm} c#tau (m) ]" : "HSCP Mass (GeV/c#kern[-0.0]{^{2}})");
   graph->GetYaxis()->SetTitle(YAxisTitle);
   graph->GetYaxis()->SetTitleOffset(1.45);
   return graph;
}

TGraphErrors* MakeGraphRatio(TGraphErrors* A, TGraphErrors* B){
   TGraphErrors* toReturn = new TGraphErrors(A->GetN());   
   for(int i=0;i<A->GetN();i++){
      double x, ayval, ayerr, byval, byerr;
      A->GetPoint(i, x, ayval);  ayerr = A->GetErrorY(i);
      B->GetPoint(i, x, byval);  byerr = B->GetErrorY(i);
      ayerr=sqrt(pow(ayerr/byval,2) + pow(byerr*ayval/(byval*byval),2));  ayval/=byval;
      if(byval<=0){ayval=0.0, ayerr=0.0;}
      if(ayval<=0){ayval=0.0, ayerr=0.0;}
      toReturn->SetPoint(i, x, ayval);
      toReturn->SetPointError(i, 0, ayerr);
   }
   return toReturn; 
}


void MakePlot_PMSSM(){


      TH1D* HCtau  = new TH1D("HCtau" , "HCtau;log_{10} [ #chi_{1}^{#pm} c#tau (m) ];# points", 200, -19,21 );
      TH1D* HCtauS = new TH1D("HCtauS", "HCtau;log_{10} [ #chi_{1}^{#pm} c#tau (m) ];# points", 200, -19,21 );
      TH1D* HCtauE = new TH1D("HCtauE", "HCtau;log_{10} [ #chi_{1}^{#pm} c#tau (m) ];# points", 200, -19,21 );
      TH1D* HCtauL = new TH1D("HCtauL", "HCtau;log_{10} [ #chi_{1}^{#pm} c#tau (m) ];# points", 200, -19,21 );
      TH1D* HCtauM = new TH1D("HCtauM", "HCtau;log_{10} [ #chi_{1}^{#pm} c#tau (m) ];# points", 200, -19,21 );

      TH2D* HMM  = new TH2D("HMM" , "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});#chi_{1}^{0} Mass (GeV/c#kern[-0.0]{^{2}})", 75, 0,2500, 45, 0, 1500 );
      TH2D* HMME = new TH2D("HMME", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});#chi_{1}^{0} Mass (GeV/c#kern[-0.0]{^{2}})", 75, 0,2500, 45, 0, 1500 );
      TH2D* HMMS = new TH2D("HMMS", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});#chi_{1}^{0} Mass (GeV/c#kern[-0.0]{^{2}})", 75, 0,2500, 45, 0, 1500 );
      TH2D* HMML = new TH2D("HMML", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});#chi_{1}^{0} Mass (GeV/c#kern[-0.0]{^{2}})", 75, 0,2500, 45, 0, 1500 );

      TH2D* HMm  = new TH2D("HMm" , "HMm;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #Delta Mass(#chi_{1}^{#pm} - #chi_{1}^{0}) (GeV/c#kern[-0.0]{^{2}}) ]", 75, 0,2500, 45, -3, 6 );
      TH2D* HMmE = new TH2D("HMmE", "HMm;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #Delta Mass(#chi_{1}^{#pm} - #chi_{1}^{0}) (GeV/c#kern[-0.0]{^{2}}) ]", 75, 0,2500, 45, -3, 6 );
      TH2D* HMmS = new TH2D("HMmS", "HMm;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #Delta Mass(#chi_{1}^{#pm} - #chi_{1}^{0}) (GeV/c#kern[-0.0]{^{2}}) ]", 75, 0,2500, 45, -3, 6 );
      TH2D* HMmL = new TH2D("HMmL", "HMm;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #Delta Mass(#chi_{1}^{#pm} - #chi_{1}^{0}) (GeV/c#kern[-0.0]{^{2}}) ]", 75, 0,2500, 45, -3, 6 );


      TH2D* HMT  = new TH2D("HMT" , "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #chi_{1}^{#pm}  c#tau (m) ]", 75, 0,2500, 200, -19,16 );
      TH2D* HMTE = new TH2D("HMTE", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #chi_{1}^{#pm}  c#tau (m) ]", 75, 0,2500, 200, -19,16 );
      TH2D* HMTS = new TH2D("HMTS", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #chi_{1}^{#pm}  c#tau (m) ]", 75, 0,2500, 200, -19,16 );
      TH2D* HMTL = new TH2D("HMTL", "HMM;#chi_{1}^{#pm} Mass (GeV/c#kern[-0.0]{^{2}});log_{10} [ #chi_{1}^{#pm}  c#tau (m) ]", 75, 0,2500, 200, -19,16 );

      //convert from one Id type to another
      std::map<int, int> MapAssociation;
      FILE* pFile=fopen("pMSSM/rundict.txt", "r");
      if(!pFile){printf("%s does not exist\n", "pMSSM/rundict.txt"); exit(0); }
      char line[4096];
      while(fgets(line, 4096, pFile)){
         int Id, chain, longId;
         sscanf(line, "%i pMSSM12_MCMC1_%i_%i", &Id, &chain, &longId);
//         MapAssociation[longId] = Id;
         MapAssociation[Id] = longId;
         //printf("Associate %i to %i (%i)\n", longId, Id, chain);
      }
      fclose(pFile);

      TFile* file = NULL;
      TTree* tree = NULL;
      std::map<int, double> pointSigma;
      int NTEST=0, NTEST0=0, NTEST1=0, NTEST2=0;
      int TESTA=0, TESTB=0;

      double Count100m=0, Count100mE=0;
      double Count50m=0, Count50mE=0;
      double Count1m=0, Count1mE=0;
      double Count10mm=0, Count10mmE=0;

      //find what is already excluded by the 8TeV analyses
      file = TFile::Open("pMSSM/pMSSMtree_lhd.root");
      if(!file || file->IsZombie())return;
      tree = (TTree*)file->Get("pMSSM");
      if(!tree)return;
      int TID; double Tsig12024, Tsig13012;
      tree->GetBranch("ID"            )->SetAddress(&TID    );
      tree->GetBranch("SUS12024_Z_100")->SetAddress(&Tsig12024   );
      tree->GetBranch("SUS13012_Z_100")->SetAddress(&Tsig13012   );
      for(int ientry=0;ientry<tree->GetEntriesFast();ientry++){
        tree->GetEntry(ientry);
//        pointSigma[TID] = std::min(Tsig12024, Tsig13012); //set to 0 because these analysis are 8TeV analyses
        pointSigma[MapAssociation[TID]] = 0;
      }

      //find what is already excluded by the 7TeV analyses
      //this list only contains the event that are excluded by SUS12030
      for(unsigned int i=0;i<sizeof(ExcludedBySUS12030)/sizeof(int); i++){
         pointSigma[(int)ExcludedBySUS12030[i]]    = -2.0;        
         NTEST++;
      }

      printf("Number of point excluded = %i\n", (int)sizeof(ExcludedBySUS12030)/sizeof(int));
 
//      TFile* file = TFile::Open("pMSSM_ctauGT10m.root");
      file = TFile::Open("pMSSM/pMSSM12_56K_full.root");
      if(!file || file->IsZombie())return;
      tree = (TTree*)file->Get("MCMC");
      if(!tree)return;
      double Tmass, Tctau, Titr, TmassC0, Tchainno, Tich, Tmh;
      tree->GetBranch("mw1"          )->SetAddress(&Tmass    );
      tree->GetBranch("mz1"          )->SetAddress(&TmassC0    );
      tree->GetBranch("ctau"         )->SetAddress(&Tctau   );
      tree->GetBranch("itr"          )->SetAddress(&Titr   );
      tree->GetBranch("mh"          )->SetAddress(&Tmh   );
      for(int ientry=0;ientry<tree->GetEntriesFast();ientry++){
//if(ientry>100)continue;//DEBUG

        tree->GetEntry(ientry);
       Tctau/=1000.0; //mm-->m 

//        if(fabs(Tmh-125.5)>2.5)continue;
 
//        char buffer[255]; sprintf(buffer, "pictures/pMSSM_%i.0.txt", (int)Titr);
        char buffer[255]; sprintf(buffer, "pictures/pMSSMInc_%i.0.txt", (int)Titr);
        if(Titr==974876 || Titr==666446 || Titr==623551 || Titr==708741){  //don't know why, but inclusive prod. for these points fails, so let's use pp production
           sprintf(buffer, "pictures/pMSSM_%i.0.txt", (int)Titr);        
        }

        std::vector<dataModel> results;
        if(Tctau>=0.5) results = readFromFile(buffer, Tmass);  //XXX
        double weight=1.0;

        //Sezen and Lukas only considered a fraction of the events with ctau<10mm to run the analysis
        //since I consider the entire fraction, I must scale this fraction up by 5.58 
        //5.58 = 40891 (in my ntuples with ctau<10mm)  / 7298 events considered by lukas/sezen
        //otherwise skip the event to avoid double counting
        if(Tctau<0.01){
           if(pointSigma.find((int)Titr)!=pointSigma.end()){
              weight*=5.58;
              NTEST2++;                
            }else{
               continue;
            }
        }


        int MassCut = std::min((int(Tmass * 0.6)/100), 3);

        if(Tctau>100)Count100m+=weight;
        if(Tctau>50)Count50m+=weight;
        if(Tctau>1)Count1m+=weight;
        if(Tctau<0.01)Count10mm+=weight;

        if(Tctau>100){
           TESTA++;
           if(results.size()>0 && results[MassCut].Limits[5]<results[MassCut].ThXSec && results[MassCut].Limits[5]>0){ TESTB++; }
           else{
           printf("P=%4i : M=%f decaylength=%Em  Eff=%E THXsec=%E  LimitXsec=%E\n", TESTA, Tmass, Tctau,  results[MassCut].OEff, results[MassCut].ThXSec, results[MassCut].Limits[5]);
           }
        }

        if(Tctau)

        if(Tctau<0.01 && pointSigma[(int)Titr]<-1.64){  //ECLUDED BY SUSY
           NTEST1++;
           HCtauS->Fill(log10(Tctau), weight);
           HMMS->Fill(Tmass, TmassC0, weight); 
           HMmS->Fill(Tmass, log10(Tmass-TmassC0), weight);
           HMTS->Fill(Tmass, log10(Tctau), weight);
           Count10mmE+=weight;
        }else if(Tctau>=0.5 && results.size()<=0){  //XXX
           HCtauM->Fill(log10(Tctau), weight);   //POINTS THAT FAILLED IN HSCP
           printf("POINT THAT FAILLED : M=%f decaylength=%Em\n", Tmass, Tctau);
        }else if(Tctau>=0.5 && results.size()>0 && results[MassCut].Limits[5]<results[MassCut].ThXSec && results[MassCut].Limits[5]>0){  //EXCLUDED BY HSCP  //XXX
          if(Tctau>100)Count100mE+=weight;
          if(Tctau>50)Count50mE+=weight;
          if(Tctau>1)Count1mE+=weight;           
           HCtauE->Fill(log10(Tctau), weight);  
           HMME->Fill(Tmass, TmassC0, weight); 
           HMmE->Fill(Tmass, log10(Tmass-TmassC0), weight);
           HMTE->Fill(Tmass, log10(Tctau), weight);

        }else{ //UNEXCLUDED
           HCtauL->Fill(log10(Tctau), weight);/*   printf("%10f --> %6.2E  %6.2E\n", Titr, MapAssociation[(int)Titr], Tctau);*/
           HMML->Fill(Tmass, TmassC0, weight); 
           HMmL->Fill(Tmass, log10(Tmass-TmassC0), weight);
           HMTL->Fill(Tmass, log10(Tctau), weight);

           if(log10(Tctau)>4)printf("POINT AT HIGH CTAU : M=%f decaylength=%Em  Eff=%E THXsec=%E  LimitXsec=%E\n", Tmass, Tctau,  results[MassCut].OEff, results[MassCut].ThXSec, results[MassCut].Limits[5]);

//           if(Tctau>=5){
//              printf("Unexcluded: %8f --> Mw=%6.2f  Mz=%6.2f  ctau=%6.2E  th=%6.2E  obs=%6.2E  %i\n", Titr, Tmass, TmassC0, Tctau, results[MassCut].ThXSec, results[MassCut].Limits[5], (int)results.size());
//           }
        }
        HCtau->Fill(log10(Tctau), weight);
        HMM->Fill(Tmass, TmassC0, weight);
        HMm->Fill(Tmass, log10(Tmass-TmassC0), weight);
        HMT->Fill(Tmass, log10(Tctau), weight);
      }
      printf("Number of point excluded = %f over %f)\n", HCtauS->Integral(), HCtau->Integral());
      printf("NTEST=%i NTEST0=%i NTEST1=%i NTEST2=%i\n", NTEST, NTEST0, NTEST1, NTEST2);
      printf("TESTA = %i   TESTB=%i\n", TESTA, TESTB);

     printf("Faction of unexcluded point with ctau>100m = %f\n", 1.0 - (Count100mE/Count100m) );
     printf("Faction of unexcluded point with ctau> 50m = %f\n", 1.0 - (Count50mE/Count50m) );
     printf("Faction of unexcluded point with ctau>  1m = %f\n", 1.0 - (Count1mE/Count1m)  );
     printf("Faction of unexcluded point with ctau<10mm = %f\n", 1.0 - (Count10mmE/Count10mm) );

     printf("%f total    number of points with ctau<10mm\n", HCtau ->Integral(-1, HCtau ->FindBin(log10(0.01))));
     printf("%f excluded number of points with ctau<10mm\n", HCtauS->Integral(-1, HCtauS->FindBin(log10(0.01))));

     printf("Fraction of pMSSM models predicting short-lived particles = %f\n", HCtau->Integral(HCtau->FindBin(log10(0.01)), HCtau->FindBin(log10(0.5))) /  HCtau->Integral());

     TCanvas*  c1 = NULL;
     TPaveText *T = NULL;

     TPaveText* T1 = new TPaveText(0.50, 0.95, 0.88, 1.0);
     T1->SetTextFont(43); T1->SetTextSize(23);   T1->SetTextAlign(32);
     T1->SetFillColor(0); T1->SetFillStyle(0);   T1->SetBorderSize(0);
     T1->AddText("18.8 fb^{-1} (8 TeV)");

     TPaveText* T2 = new TPaveText(0.14, 0.88, 0.85, 0.93);
     T2->SetTextFont(63); T2->SetTextSize(30);   T2->SetTextAlign(12);
     T2->SetFillColor(0); T2->SetFillStyle(0);   T2->SetBorderSize(0);
     T2->AddText("CMS");

     TPaveText* T3 = new TPaveText(0.14, 0.84, 0.85, 0.89);
     T3->SetTextFont(53); T3->SetTextSize(23);   T3->SetTextAlign(12);
     T3->SetFillColor(0); T3->SetFillStyle(0);   T3->SetBorderSize(0);
     T3->AddText("Unpublished");

     TPaveText* T4 = new TPaveText(0.50, 0.95, 0.88, 1.0, "NDC");
     T4->SetTextFont(43); T4->SetTextSize(23);   T4->SetTextAlign(32);
     T4->SetFillColor(0); T4->SetFillStyle(0);   T4->SetBorderSize(0);
     T4->AddText("Simulation (8 TeV)");


     char saveName[256];       
     for(unsigned int PLOT=0;PLOT<=1;PLOT++){
        c1 = new TCanvas("c1", "c1", 600,600);

        TPad* t1 = new TPad("t1","t1", 0.0, 0.25, 1.0, 1.0);
        t1->Draw();
        t1->cd();
        t1->SetTopMargin(0.06);
        t1->SetBottomMargin(0.13);
        t1->SetLogy(true);


        THStack* stack = new THStack("stack","stack;log_{10}[ c#tau (m) ]; points in pMSSM LHC subspace");
        HCtauL->SetLineWidth(2);
        HCtauL->SetLineColor(1);
        HCtauL->SetFillColor(10);
        HCtau->SetLineWidth(2);
        HCtau->SetLineColor(1);
        HCtau->SetFillColor(10);
   //     HCtau->Draw();
        HCtauS->SetLineWidth(2);
        HCtauS->SetLineColor(4);
        HCtauS->SetFillColor(4);
        HCtauS->SetFillStyle(3004);
   //     HCtauS->Draw("same");
        HCtauE->SetLineWidth(2);
        HCtauE->SetLineColor(2);
        HCtauE->SetFillColor(2);
        HCtauE->SetFillStyle(3005);
   //     HCtauE->Draw("same");


        HCtauM->SetLineWidth(1);
        HCtauM->SetLineColor(1);
        HCtauM->SetFillColor(1);
        HCtauM->SetFillStyle(1);

//        stack->Add(HCtau);
   //     stack->Add(HCtauM);
        stack->Add(HCtauL);
        stack->Add(HCtauE);
//        stack->Add(HCtauS);

        stack->Draw("");
   //     stack->SetTitle("");
        stack->GetXaxis()->SetTitleOffset(1.50);
        stack->GetYaxis()->SetTitleOffset(1.50);
        stack->SetMaximum(9E3);
        stack->SetMinimum(0.5);
        stack->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
        stack->GetXaxis()->SetLabelSize(22); //font size
        stack->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
        stack->GetXaxis()->SetTitleSize(22); //font size
        stack->GetXaxis()->SetNdivisions(510);
        stack->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
        stack->GetYaxis()->SetLabelSize(22); //font size
        stack->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
        stack->GetYaxis()->SetTitleSize(22); //font size
        stack->GetYaxis()->SetNdivisions(510);    
        if(PLOT==0)stack->GetXaxis()->SetRangeUser(-19,21.0);
        if(PLOT==1)stack->GetXaxis()->SetRangeUser(-1.0,6.0);

        TPaveText* legT = new TPaveText(0.53,0.90,0.83,0.90-2*0.05, "NDC");   legT->SetFillColor(0); legT->SetFillStyle(0); legT->SetBorderSize(0); legT->SetTextAlign(31); legT->SetTextFont(43); legT->SetTextSize(23);
        legT->AddText("Constraints on pMSSM subspace"); legT->AddText("accessible at the LHC Run1:"); legT->Draw("same");

  //      TLegend* leg = new TLegend(0.56,0.85,0.79,0.85-(3-PLOT)*0.075);
        TLegend* leg = new TLegend(0.56,0.85,0.79,0.85-(2)*0.075);
        leg->SetFillStyle(0);
        leg->SetBorderSize(0);
        leg->SetTextFont(43);
        leg->SetTextSize(23);
        leg->SetHeader(NULL);//"pMSSM LHC subspace");
   //     leg->AddEntry(HCtau , "all points" ,"F");
//        leg->AddEntry("", "excluded by :" ,"");
        leg->AddEntry(HCtauE, "HSCP search" ,"F");
//        if(PLOT==0)leg->AddEntry(HCtauS, "SUSY search" ,"F");
        leg->AddEntry(HCtauL, "unexcluded" ,"F");
        leg->Draw();


        c1->cd();
        TPad* t2 = new TPad("t2","t2", 0.0, 0.0, 1.0, 0.25);
        t2->Draw();
        t2->cd();
        t2->SetGridx(true);
        t2->SetGridy(true);
        t2->SetTopMargin(0.04);
        t2->SetBottomMargin(0.14);
   //     t2->SetLogy(true);

        TH1D* frameR = NULL;
        frameR = new TH1D("frameR", "frameR", 200,-19.0, 21.0);
        frameR->SetTitle("");
        frameR->SetStats(kFALSE);
        frameR->GetXaxis()->SetTitleOffset(1.50);
        frameR->GetYaxis()->SetTitle("Frac. Excluded");
        frameR->GetYaxis()->SetTitleOffset(1.50);
        frameR->SetMaximum(1.05);   
        frameR->SetMinimum(0);
        frameR->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
        frameR->GetXaxis()->SetLabelSize(22); //font size
        frameR->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
        frameR->GetXaxis()->SetTitleSize(22); //font size
        frameR->GetXaxis()->SetNdivisions(510);
        frameR->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
        frameR->GetYaxis()->SetLabelSize(22); //font size
        frameR->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
        frameR->GetYaxis()->SetTitleSize(22); //font size
        frameR->GetYaxis()->SetNdivisions(510);
        frameR->Draw("AXIS");
        if(PLOT==0)frameR->GetXaxis()->SetRangeUser(-19,21.0);
        if(PLOT==1)frameR->GetXaxis()->SetRangeUser(-1.0,6.0);

        TH1D* HCtauERatio = ((TH1D*) HCtauE->Clone("HCtauERatio")); HCtauERatio->Divide(HCtau);  HCtauERatio->Draw("same");
//        TH1D* HCtauSRatio = ((TH1D*) HCtauS->Clone("HCtauSRatio")); HCtauSRatio->Divide(HCtau);  if(PLOT==0)HCtauSRatio->Draw("same");

         c1->cd(0);

/*
        T = new TPaveText(0.0, 0.97, 1.0, 0.99);
        T->SetTextFont(43);  //give the font size in pixel (instead of fraction)
        T->SetTextSize(21);  //font size
        T->SetFillColor(0);
        T->SetTextAlign(22);
         T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");
   //     T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -  Simulation");
        T->Draw("same");
*/

        T1->Draw("same");
        T2->Draw("same");


         sprintf(saveName,"pictures/pMSSM_vs_ctau%s.png", PLOT==1?"Zoom":"");  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/pMSSM_vs_ctau%s.pdf", PLOT==1?"Zoom":"");  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/pMSSM_vs_ctau%s.C"  , PLOT==1?"Zoom":"");    c1->SaveAs(saveName);
//         stack->GetXaxis()->SetRangeUser(-1.0,6.0);
         c1->cd(0); 
         delete c1;
       }

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMM->Draw("CONTZ"); 
      HMM->GetXaxis()->SetTitleOffset(1.40);
      HMM->GetYaxis()->SetTitleOffset(1.40);
      HMM->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMM->GetXaxis()->SetLabelSize(22); //font size
      HMM->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMM->GetXaxis()->SetTitleSize(22); //font size
      HMM->GetXaxis()->SetNdivisions(510);
      HMM->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMM->GetYaxis()->SetLabelSize(22); //font size
      HMM->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMM->GetYaxis()->SetTitleSize(22); //font size
      HMM->GetYaxis()->SetNdivisions(510);
      HMM->SetMaximum(500); 
      HMM->SetMinimum(0.5);
      T2->Draw("same");
      T4->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-2*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23); 
      T->AddText("complete pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(23); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Raw pMSSM LHC subspace");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MM.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MM.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMMS->GetXaxis()->SetTitleOffset(1.40);
      HMMS->GetYaxis()->SetTitleOffset(1.40);
      HMMS->Draw("CONTZ");
      HMMS->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMMS->GetXaxis()->SetLabelSize(22); //font size
      HMMS->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMMS->GetXaxis()->SetTitleSize(22); //font size
      HMMS->GetXaxis()->SetNdivisions(510);
      HMMS->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMMS->GetYaxis()->SetLabelSize(22); //font size
      HMMS->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMMS->GetYaxis()->SetTitleSize(22); //font size
      HMMS->GetYaxis()->SetNdivisions(510);
      HMMS->SetMaximum(500); 
      HMMS->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23); 
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by SUSY searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MMS.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MMS.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMME->GetXaxis()->SetTitleOffset(1.40);
      HMME->GetYaxis()->SetTitleOffset(1.40);
      HMME->Draw("CONTZ");
      HMME->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMME->GetXaxis()->SetLabelSize(22); //font size
      HMME->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMME->GetXaxis()->SetTitleSize(22); //font size
      HMME->GetXaxis()->SetNdivisions(510);
      HMME->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMME->GetYaxis()->SetLabelSize(22); //font size
      HMME->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMME->GetYaxis()->SetTitleSize(22); //font size
      HMME->GetYaxis()->SetNdivisions(510);
      HMME->SetMaximum(500); 
      HMME->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);  
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by HSCP search"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by EXO-13-006");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MME.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MME.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMML->GetXaxis()->SetTitleOffset(1.40);
      HMML->GetYaxis()->SetTitleOffset(1.40);
      HMML->Draw("CONTZ");
      HMML->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMML->GetXaxis()->SetLabelSize(22); //font size
      HMML->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMML->GetXaxis()->SetTitleSize(22); //font size
      HMML->GetXaxis()->SetNdivisions(510);
      HMML->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMML->GetYaxis()->SetLabelSize(22); //font size
      HMML->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMML->GetYaxis()->SetTitleSize(22); //font size
      HMML->GetYaxis()->SetNdivisions(510);
      HMML->SetMaximum(500); 
      HMML->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-4*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23); 
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("not excluded by SUSY"); T->AddText("nor HSCP searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Not excluded by EXO-13-006"); T->AddText("nor SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MML.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MML.pdf");  c1->SaveAs(saveName);
      delete c1;


      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMm->Draw("CONTZ"); 
      HMm->GetXaxis()->SetTitleOffset(1.40);
      HMm->GetYaxis()->SetTitleOffset(1.40);
      HMm->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMm->GetXaxis()->SetLabelSize(22); //font size
      HMm->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMm->GetXaxis()->SetTitleSize(22); //font size
      HMm->GetXaxis()->SetNdivisions(510);
      HMm->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMm->GetYaxis()->SetLabelSize(22); //font size
      HMm->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMm->GetYaxis()->SetTitleSize(22); //font size
      HMm->GetYaxis()->SetNdivisions(510);
      HMm->SetMaximum(500); 
      HMm->SetMinimum(0.5);
      T2->Draw("same");
      T4->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-2*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23); 
      T->AddText("complete pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Raw pMSSM LHC subspace");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_Mm.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_Mm.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMmS->GetXaxis()->SetTitleOffset(1.40);
      HMmS->GetYaxis()->SetTitleOffset(1.40);
      HMmS->Draw("CONTZ");
      HMmS->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmS->GetXaxis()->SetLabelSize(22); //font size
      HMmS->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmS->GetXaxis()->SetTitleSize(22); //font size
      HMmS->GetXaxis()->SetNdivisions(510);
      HMmS->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmS->GetYaxis()->SetLabelSize(22); //font size
      HMmS->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmS->GetYaxis()->SetTitleSize(22); //font size
      HMmS->GetYaxis()->SetNdivisions(510);
      HMmS->SetMaximum(500);
      HMmS->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by SUSY searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MmS.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MmS.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMmE->GetXaxis()->SetTitleOffset(1.40);
      HMmE->GetYaxis()->SetTitleOffset(1.40);
      HMmE->Draw("CONTZ");
      HMmE->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmE->GetXaxis()->SetLabelSize(22); //font size
      HMmE->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmE->GetXaxis()->SetTitleSize(22); //font size
      HMmE->GetXaxis()->SetNdivisions(510);
      HMmE->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmE->GetYaxis()->SetLabelSize(22); //font size
      HMmE->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmE->GetYaxis()->SetTitleSize(22); //font size
      HMmE->GetYaxis()->SetNdivisions(510);
      HMmE->SetMaximum(500);
      HMmE->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by HSCP search"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by EXO-13-006");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MmE.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MmE.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMmL->GetXaxis()->SetTitleOffset(1.40);
      HMmL->GetYaxis()->SetTitleOffset(1.40);
      HMmL->Draw("CONTZ");
      HMmL->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmL->GetXaxis()->SetLabelSize(22); //font size
      HMmL->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmL->GetXaxis()->SetTitleSize(22); //font size
      HMmL->GetXaxis()->SetNdivisions(510);
      HMmL->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMmL->GetYaxis()->SetLabelSize(22); //font size
      HMmL->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMmL->GetYaxis()->SetTitleSize(22); //font size
      HMmL->GetYaxis()->SetNdivisions(510);
      HMmL->SetMaximum(500);
      HMmL->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-4*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("not excluded by SUSY"); T->AddText("nor HSCP searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Not excluded by EXO-13-006"); T->AddText("nor SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MmL.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MmL.pdf");  c1->SaveAs(saveName);
      delete c1;


      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMT->Draw("CONTZ");
      HMT->GetXaxis()->SetTitleOffset(1.40);
      HMT->GetYaxis()->SetTitleOffset(1.40);
      HMT->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMT->GetXaxis()->SetLabelSize(22); //font size
      HMT->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMT->GetXaxis()->SetTitleSize(22); //font size
      HMT->GetXaxis()->SetNdivisions(510);
      HMT->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMT->GetYaxis()->SetLabelSize(22); //font size
      HMT->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMT->GetYaxis()->SetTitleSize(22); //font size
      HMT->GetYaxis()->SetNdivisions(510);
      HMT->SetMaximum(500);
      HMT->SetMinimum(0.5);
      T2->Draw("same");
      T4->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-2*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("complete pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Raw pMSSM LHC subspace");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MT.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MT.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMTS->GetXaxis()->SetTitleOffset(1.40);
      HMTS->GetYaxis()->SetTitleOffset(1.40);
      HMTS->Draw("CONTZ");
      HMTS->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTS->GetXaxis()->SetLabelSize(22); //font size
      HMTS->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTS->GetXaxis()->SetTitleSize(22); //font size
      HMTS->GetXaxis()->SetNdivisions(510);
      HMTS->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTS->GetYaxis()->SetLabelSize(22); //font size
      HMTS->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTS->GetYaxis()->SetTitleSize(22); //font size
      HMTS->GetYaxis()->SetNdivisions(510);
      HMTS->SetMaximum(500);
      HMTS->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by SUSY searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MTS.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MTS.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMTE->GetXaxis()->SetTitleOffset(1.40);
      HMTE->GetYaxis()->SetTitleOffset(1.40);
      HMTE->Draw("CONTZ");
      HMTE->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTE->GetXaxis()->SetLabelSize(22); //font size
      HMTE->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTE->GetXaxis()->SetTitleSize(22); //font size
      HMTE->GetXaxis()->SetNdivisions(510);
      HMTE->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTE->GetYaxis()->SetLabelSize(22); //font size
      HMTE->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTE->GetYaxis()->SetTitleSize(22); //font size
      HMTE->GetYaxis()->SetNdivisions(510);
      HMTE->SetMaximum(500);
      HMTE->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-3*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("excluded by HSCP search"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Excluded by EXO-13-006");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MTE.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MTE.pdf");  c1->SaveAs(saveName);
      delete c1;

      c1 = new TCanvas("c1", "c1", 600, 600);
      c1->SetRightMargin (0.15); //c1->SetLeftMargin  (0.15);
      c1->SetLogz(true);
      HMTL->GetXaxis()->SetTitleOffset(1.40);
      HMTL->GetYaxis()->SetTitleOffset(1.40);
      HMTL->Draw("CONTZ");
      HMTL->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTL->GetXaxis()->SetLabelSize(22); //font size
      HMTL->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTL->GetXaxis()->SetTitleSize(22); //font size
      HMTL->GetXaxis()->SetNdivisions(510);
      HMTL->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
      HMTL->GetYaxis()->SetLabelSize(22); //font size
      HMTL->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
      HMTL->GetYaxis()->SetTitleSize(22); //font size
      HMTL->GetYaxis()->SetNdivisions(510);
      HMTL->SetMaximum(500);
      HMTL->SetMinimum(0.5);
      T1->Draw("same");
      T2->Draw("same");
      T = new TPaveText(0.25,0.91,0.85,0.91-4*0.045, "NDC");   T->SetFillColor(0); T->SetFillStyle(0); T->SetBorderSize(0); T->SetTextAlign(32); T->SetTextFont(43); T->SetTextSize(23);
      T->AddText("pMSSM subspace"); T->AddText("accessible at the LHC Run1"); T->AddText("not excluded by SUSY"); T->AddText("nor HSCP searches"); T->Draw("same");
//      T = new TPaveText(0.0, 0.97, 1.0, 0.99, "NDC"); T->SetFillColor(0); T->SetTextAlign(22); T->SetTextFont(43); T->SetTextSize(21); T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");      T->Draw("same");
//      T = new TPaveText(0.25,0.91,0.5,0.85, "NDC");   T->SetFillColor(0); T->SetTextAlign(12); T->SetTextFont(43); T->SetTextSize(21); T->AddText("Not excluded by EXO-13-006");T->AddText("nor SUS-12-030");  T->Draw("same");
      sprintf(saveName,"pictures/pMSSM_MTL.png");  c1->SaveAs(saveName);
      sprintf(saveName,"pictures/pMSSM_MTL.pdf");  c1->SaveAs(saveName);
      delete c1;
}





void MakePlot_Comparison()
{
   setTDRStyle();
   gStyle->SetPadTopMargin   (0.06);
   gStyle->SetPadBottomMargin(0.10);
   gStyle->SetPadRightMargin (0.13);
   gStyle->SetPadLeftMargin  (0.15);
   gStyle->SetTitleSize(0.04, "XYZ");
   gStyle->SetTitleXOffset(1.1);
   gStyle->SetTitleYOffset(1.35);
   gStyle->SetPalette(1);
   gStyle->SetNdivisions(505);
   gStyle->SetPaintTextFormat("4.2f");
   gStyle->SetOptStat("");

   MakePlot_PMSSM();
//   return;

   std::vector< std::vector<dataModel> > dms_PP_ST;
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M100.txt", 100.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M126.txt", 126.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M156.txt", 156.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M200.txt", 200.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M247.txt", 247.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M308.txt", 308.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M370.txt", 370.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M432.txt", 432.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M494.txt", 494.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M557.txt", 557.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M651.txt", 651.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M745.txt", 745.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M871.txt", 871.0));
   dms_PP_ST.push_back(readFromFile("pictures/Std_PPStau_8TeV_M1029.txt",1029.0));

   std::vector< std::vector<dataModel> > dms_PP_MI;
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M100.txt", 100.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M126.txt", 126.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M156.txt", 156.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M200.txt", 200.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M247.txt", 247.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M308.txt", 308.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M370.txt", 370.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M432.txt", 432.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M494.txt", 494.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M557.txt", 557.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M651.txt", 651.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M745.txt", 745.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M871.txt", 871.0));
   dms_PP_MI.push_back(readFromFile("pictures/MI_PPStau_8TeV_M1029.txt",1029.0));

   std::vector< std::vector<dataModel> > dms_GM_ST;
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M100.txt", 100.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M126.txt", 126.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M156.txt", 156.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M200.txt", 200.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M247.txt", 247.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M308.txt", 308.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M370.txt", 370.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M432.txt", 432.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M494.txt", 494.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M557.txt", 557.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M651.txt", 651.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M745.txt", 745.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M871.txt", 871.0));
   dms_GM_ST.push_back(readFromFile("pictures/Std_GMStau_8TeV_M1029.txt",1029.0));

   std::vector< std::vector<dataModel> > dms_GM_MI;
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M100.txt", 100.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M126.txt", 126.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M156.txt", 156.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M200.txt", 200.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M247.txt", 247.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M308.txt", 308.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M370.txt", 370.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M432.txt", 432.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M494.txt", 494.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M557.txt", 557.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M651.txt", 651.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M745.txt", 745.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M871.txt", 871.0));
   dms_GM_MI.push_back(readFromFile("pictures/MI_GMStau_8TeV_M1029.txt",1029.0));


   std::vector< std::vector<dataModel> > dms_DY_ST;
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M100_Q1.txt", 100.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M200_Q1.txt", 200.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M300_Q1.txt", 300.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M400_Q1.txt", 400.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M500_Q1.txt", 500.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M600_Q1.txt", 600.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M700_Q1.txt", 700.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M800_Q1.txt", 800.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M900_Q1.txt", 900.0));
   dms_DY_ST.push_back(readFromFile("pictures/Std_DY_8TeV_M1000_Q1.txt", 1000.0));
   
   std::vector< std::vector<dataModel> > dms_DY_MI;
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M100.txt", 100.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M200.txt", 200.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M300.txt", 300.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M400.txt", 400.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M500.txt", 500.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M600.txt", 600.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M700.txt", 700.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M800.txt", 800.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M900.txt", 900.0));
   dms_DY_MI.push_back(readFromFile("pictures/MI_DY_8TeV_M1000.txt", 1000.0));

   std::vector< std::vector<dataModel> > dms_pMSSM_ST;
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M100.txt", 100.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M200.txt", 200.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M300.txt", 300.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M400.txt", 400.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M500.txt", 500.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M600.txt", 600.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M700.txt", 700.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M800.txt", 800.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M900.txt", 900.0));
   dms_pMSSM_ST.push_back(readFromFile("pictures/Std_pMSSM_8TeV_M1000.txt", 1000.0));

   std::vector< std::vector<dataModel> > dms_pMSSM_MI;
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M100.txt", 100.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M200.txt", 200.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M300.txt", 300.0)); 
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M400.txt", 400.0)); 
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M500.txt", 500.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M600.txt", 600.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M700.txt", 700.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M800.txt", 800.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M900.txt", 900.0));
   dms_pMSSM_MI.push_back(readFromFile("pictures/MI_pMSSM_8TeV_M1000.txt", 1000.0));


   std::vector< std::vector<dataModel> > dms_pMSSMMO_ST;
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M100.txt", 100.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M200.txt", 200.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M300.txt", 300.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M400.txt", 400.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M500.txt", 500.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M600.txt", 600.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M700.txt", 700.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M800.txt", 800.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M900.txt", 900.0));
   dms_pMSSMMO_ST.push_back(readFromFile("pictures/Std_pMSSM_MassOnly_8TeV_M1000.txt", 1000.0));

   std::vector< std::vector<dataModel> > dms_pMSSMMO_MI;
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M100.txt", 100.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M200.txt", 200.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M300.txt", 300.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M400.txt", 400.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M500.txt", 500.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M600.txt", 600.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M700.txt", 700.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M800.txt", 800.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M900.txt", 900.0));
   dms_pMSSMMO_MI.push_back(readFromFile("pictures/MI_pMSSM_MassOnly_8TeV_M1000.txt", 1000.0));




   double TeresaCTau[]= {0.5, 0.75, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.5, 6.0, 8.0, 10., 15., 20., 30.};

   std::vector< std::vector<dataModel> > dms_pMSSMTeresa_ST[9];
   std::vector< std::vector<dataModel> > dms_pMSSMTeresa_MI[9];
   for(int l=0;l<9;l++){
   for(unsigned int m=0;m<sizeof(TeresaCTau)/sizeof(double);m++){
         char buffer[1024];

         sprintf(buffer, "pictures/Std_TeresapMSSM12_MCMC1_30_549144_m%3i_width%i.txt", (l+1)*100, m);
         cout<<buffer<<endl;
         dms_pMSSMTeresa_ST[l].push_back(readFromFile(buffer, (l+1)*100.0,  TeresaCTau[m]));

         sprintf(buffer, "pictures/MI_pMSSM12_MCMC1_30_549144_m%3i_width%i.txt", (l+1)*100, m);   
         cout<<buffer<<endl;
         dms_pMSSMTeresa_MI[l].push_back(readFromFile(buffer, (l+1)*100.0, TeresaCTau[  m]));
      }
   }

   for(unsigned int M=0;M<5+7;M++){
      TString ModelName, LegendName;
      std::vector< std::vector<dataModel> > dms_ST;
      std::vector< std::vector<dataModel> > dms_MI;

      TGraph* ThXSec    = NULL;
      TCutG*  ThXSecErr = NULL;

      switch(M){
         case 0:
            ModelName = "PPStau";             LegendName="Pair Prod. Staus";
            dms_ST = dms_PP_ST;
            dms_MI = dms_PP_MI;
            ThXSec    = new TGraph(sizeof(THXSEC8TeV_PPStau_Mass)/sizeof(double), THXSEC8TeV_PPStau_Mass, THXSEC8TeV_PPStau_Cen);
            ThXSecErr = GetErrorBand("PPtauThErr", sizeof(THXSEC8TeV_PPStau_Mass)/sizeof(double),THXSEC8TeV_PPStau_Mass,THXSEC8TeV_PPStau_Low,THXSEC8TeV_PPStau_High, 0.0001, 0.05);
            break;

         case 1:
            ModelName = "GMStau";;             LegendName="Inc. Prod. Staus";
            dms_ST = dms_GM_ST;
            dms_MI = dms_GM_MI;
            ThXSec    = new TGraph(sizeof(THXSEC8TeV_GMStau_Mass)/sizeof(double), THXSEC8TeV_GMStau_Mass, THXSEC8TeV_GMStau_Cen);
            ThXSecErr = GetErrorBand("GMSBStauThErr", sizeof(THXSEC8TeV_GMStau_Mass)/sizeof(double),THXSEC8TeV_GMStau_Mass,THXSEC8TeV_GMStau_Low,THXSEC8TeV_GMStau_High, 0.0001, 0.05);

            break;

         case 2:
            ModelName = "DY";;             LegendName="Pair Prod. Leptons";
            dms_ST = dms_DY_ST;
            dms_MI = dms_DY_MI;
            ThXSec    = new TGraph(sizeof(THXSEC8TeV_DYStau_Mass)/sizeof(double), THXSEC8TeV_DYStau_Mass, THXSEC8TeV_DYStau_Cen);
            ThXSecErr = GetErrorBand("DYStauThErr", sizeof(THXSEC8TeV_DYStau_Mass)/sizeof(double),THXSEC8TeV_DYStau_Mass,THXSEC8TeV_DYStau_Low,THXSEC8TeV_DYStau_High, 0.0001, 0.05);
            break;

         case 3:
            ModelName = "pMSSM";;             LegendName="pMSSM #chi_{1}^{#pm} (Stable)";
            dms_ST = dms_pMSSM_ST;
            dms_MI = dms_pMSSM_MI;
            break;

         case 4:
            ModelName = "pMSSMMO";;             LegendName="pMSSM #chi_{1}^{#pm} (Stable)";
            dms_ST = dms_pMSSMMO_ST;
            dms_MI = dms_pMSSMMO_MI;
            break;

         case 5:
            ModelName = "pMSSM_M100";;             LegendName= "pMSSM #chi_{1}^{#pm} (M = 100GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[0];
            dms_MI = dms_pMSSMTeresa_MI[0];
            break;

         case 6:
            ModelName = "pMSSM_M200";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 200GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[1];
            dms_MI = dms_pMSSMTeresa_MI[1];
            break;

         case 7:
            ModelName = "pMSSM_M300";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 300GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[2];
            dms_MI = dms_pMSSMTeresa_MI[2];
            break;

         case 8:
            ModelName = "pMSSM_M400";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 400GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[3];
            dms_MI = dms_pMSSMTeresa_MI[3];
            break;

         case 9:
            ModelName = "pMSSM_M500";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 500GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[4];
            dms_MI = dms_pMSSMTeresa_MI[4];
            break;

         case 10:
            ModelName = "pMSSM_M600";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 600GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[5];
            dms_MI = dms_pMSSMTeresa_MI[5];
            break;

         case 11:
            ModelName = "pMSSM_M700";;             LegendName="pMSSM #chi_{1}^{#pm} (M = 700GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMTeresa_ST[6];
            dms_MI = dms_pMSSMTeresa_MI[6];
            break;


      } 

//      TString ModelName = M==0?"PPStau":M==1?"GMStau":M==2?"DY":M==3?"pMSSM":"pMSSMMO";
//      std::vector< std::vector<dataModel> >& dms_ST = (M==0)?dms_PP_ST:(M==1)?dms_GM_ST:(M==2)?dms_DY_ST:(M==3)?dms_pMSSM_ST:dms_pMSSMMO_ST;
//      std::vector< std::vector<dataModel> >& dms_MI = (M==0)?dms_PP_MI:(M==1)?dms_GM_MI:(M==2)?dms_DY_MI:(M==3)?dms_pMSSM_MI:dms_pMSSMMO_MI;

      for(int LevelIndex=-2; LevelIndex<6;LevelIndex++){
         TCanvas* c1 = new TCanvas("c1","c1",600, 600);

         TPad* t1 = new TPad("t1","t1", 0.0, 0.25, 1.0, 1.0);
         t1->Draw();
         t1->cd();
         t1->SetTopMargin(0.06);
         t1->SetBottomMargin(0.13);

         TH1D* frame = NULL;
         if(M<=4){
            frame = new TH1D("frame", "frame; Mass (GeV/c#kern[-0.0]{^{2}})", 1,0,M<2?1100:1100);
            frame->GetXaxis()->SetTitle("Mass (GeV/c#kern[-0.0]{^{2}})");
         }else{
            frame = new TH1D("frame", "frame;log_{10} [ #chi_{1}^{#pm} c#tau (m) ]", 1,-1,3);
            frame->GetXaxis()->SetTitle("log_{10} [ #chi_{1}^{#pm} c#tau (m) ]");
         }
         frame->SetTitle("");
         frame->SetStats(kFALSE);
         frame->GetXaxis()->SetTitleOffset(1.50);
         frame->GetYaxis()->SetTitleOffset(1.50);
         frame->SetMaximum(100);
         frame->SetMinimum(0);
         frame->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetLabelSize(22); //font size
         frame->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetTitleSize(22); //font size
         frame->GetXaxis()->SetNdivisions(510);
         frame->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetLabelSize(22); //font size
         frame->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetTitleSize(22); //font size
         frame->GetYaxis()->SetNdivisions(510);
         frame->Draw("AXIS");

         TGraphErrors* A = MakePlot(LevelIndex, dms_ST);
         TGraphErrors* B = MakePlot(LevelIndex, dms_MI);
         TGraphErrors* R = MakeGraphRatio(B,A);
         frame->GetYaxis()->SetTitle(A->GetYaxis()->GetTitle());
         frame->SetMaximum( 1.10*std::max(A->GetMaximum(), B->GetMaximum()));
         A->SetLineColor(2);   A->SetMarkerColor(2);  A->SetMarkerStyle(4);  A->SetFillColor(0); A->Draw("same P0");
         B->SetLineColor(4);   B->SetMarkerColor(4);  B->SetMarkerStyle(8);  B->SetFillColor(0); B->Draw("same P0");
         R->SetLineColor(4);   R->SetMarkerColor(4);  R->SetMarkerStyle(8);

         TLegend* leg = NULL;
         if(M<=4){
             leg = new TLegend(0.46,0.50-0.075*((LevelIndex==0)?3:4),0.88,0.50);
         }else{
             leg = new TLegend(0.37,0.40-0.075*3,0.88,0.40);
         }
         leg->SetFillStyle(0);
         leg->SetBorderSize(0);
         leg->SetTextFont(43);
         leg->SetTextSize(23);
         leg->SetHeader(LegendName);
         leg->AddEntry(A, "Full Simulation" ,"P");
         leg->AddEntry(B, "Fast Technique" ,"P");
         leg->Draw();


         frame->SetMaximum(75);
         if(LevelIndex>0 && M<=4){
            TBox* b = new TBox(0,0,LevelIndex*100*1.60,frame->GetMaximum());
            b->SetFillColor(2);
            b->SetFillStyle(3004);
            b->Draw("same");
            leg->AddEntry(b, "M < 1.6 M#kern[-0.1]{_{req}}" ,"F");
         }else if(M>4){
            frame->SetMaximum(75);
            frame->SetMinimum(0.01);
            t1->SetLogy(true);
         }


         c1->cd();
         TPad* t2 = new TPad("t2","t2", 0.0, 0.0, 1.0, 0.25);
         t2->Draw();
         t2->cd();
         t2->SetGridx(true);
         t2->SetGridy(true);
         t2->SetTopMargin(0.04);
         t2->SetBottomMargin(0.14);

         TH1D* frameR = NULL;
         if(M<5){
            frameR = new TH1D("frameR", "frameR", 1,0,M<2?1100:1100);
         }else{
            frameR = new TH1D("frameR", "frameR", 1,-1, 3);
         }
         frameR->SetTitle("");
         frameR->SetStats(kFALSE);
         frameR->GetXaxis()->SetTitleOffset(1.50);
         frameR->GetYaxis()->SetTitle("Ratio");
         frameR->GetYaxis()->SetTitleOffset(1.50);
         frameR->SetMaximum(1.30);   
         frameR->SetMinimum(0.70);
         frameR->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetLabelSize(22); //font size
         frameR->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetTitleSize(22); //font size
         frameR->GetXaxis()->SetNdivisions(510);
         frameR->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetLabelSize(22); //font size
         frameR->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetTitleSize(22); //font size
         frameR->GetYaxis()->SetNdivisions(510);
         frameR->Draw("AXIS");

         if(M<5){
            TLine* LineAt10 = new TLine(0,1.0,1100,1.0);      LineAt10->SetLineStyle(1);   LineAt10->Draw();
            TLine* LineAt11 = new TLine(0,1.1,1100,1.1);      LineAt11->SetLineStyle(2);   LineAt11->Draw();
            TLine* LineAt12 = new TLine(0,1.2,1100,1.2);      LineAt12->SetLineStyle(2);   LineAt12->Draw();
            TLine* LineAt09 = new TLine(0,0.9,1100,0.9);      LineAt09->SetLineStyle(2);   LineAt09->Draw();
            TLine* LineAt08 = new TLine(0,0.8,1100,0.8);      LineAt08->SetLineStyle(2);   LineAt08->Draw();
         }else{
            TLine* LineAt10 = new TLine(-1,1.0,3,1.0);      LineAt10->SetLineStyle(1);   LineAt10->Draw();
            TLine* LineAt11 = new TLine(-1,1.1,3,1.1);      LineAt11->SetLineStyle(2);   LineAt11->Draw();
            TLine* LineAt12 = new TLine(-1,1.2,3,1.2);      LineAt12->SetLineStyle(2);   LineAt12->Draw();
            TLine* LineAt09 = new TLine(-1,0.9,3,0.9);      LineAt09->SetLineStyle(2);   LineAt09->Draw();
            TLine* LineAt08 = new TLine(-1,0.8,3,0.8);      LineAt08->SetLineStyle(2);   LineAt08->Draw();
         }
         R->Draw("same P2");

         if(LevelIndex>0 && M<=4){
            TBox* b = new TBox(0,frameR->GetMinimum(),LevelIndex*100*1.60,frameR->GetMaximum());
            b->SetFillColor(2);
            b->SetFillStyle(3004);
            b->Draw("same");
         }

         c1->cd();

/*
         TPaveText* T = new TPaveText(0.0, 0.97, 1.0, 0.99);
         T->SetTextFont(43);  //give the font size in pixel (instead of fraction)
         T->SetTextSize(21);  //font size
         T->SetFillColor(0);
         T->SetTextAlign(22);
         T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -  Simulation");
         T->Draw("same");
*/

         TPaveText* T1 = new TPaveText(0.50, 0.95, 0.88, 1.0);
         T1->SetTextFont(43); T1->SetTextSize(23);   T1->SetTextAlign(32);
         T1->SetFillColor(0); T1->SetFillStyle(0);   T1->SetBorderSize(0);
         T1->AddText("Simulation (8 TeV)");
         T1->Draw("same");

         TPaveText* T2 = new TPaveText(0.14, 0.89, 0.85, 0.94);
         T2->SetTextFont(63); T2->SetTextSize(30);   T2->SetTextAlign(12);
         T2->SetFillColor(0); T2->SetFillStyle(0);   T2->SetBorderSize(0);
         T2->AddText("CMS");
         T2->Draw("same");

         TPaveText* T3 = new TPaveText(0.14, 0.84, 0.85, 0.89);
         T3->SetTextFont(53); T3->SetTextSize(23);   T3->SetTextAlign(12);
         T3->SetFillColor(0); T3->SetFillStyle(0);   T3->SetBorderSize(0);
         T3->AddText("Unpublished");


         char saveName[256]; 
         sprintf(saveName,"pictures/CompPlot_%s_%i.png", ModelName.Data(), LevelIndex); c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i.C"  , ModelName.Data(), LevelIndex); c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i.pdf", ModelName.Data(), LevelIndex); c1->SaveAs(saveName);


//         T->Clear();
//         T->AddText("CMS (unpublished)  -  #sqrt{s} = 8 TeV  -  Simulation");
         T3->Draw("same");
         sprintf(saveName,"pictures/CompPlot_%s_%i_Unpublished.png", ModelName.Data(), LevelIndex); c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i_Unpublished.pdf", ModelName.Data(), LevelIndex); c1->SaveAs(saveName);

         delete c1; delete frame; delete frameR;
      }

      bool makeLimitPlot=true;
      if(makeLimitPlot){
         //MakeLimitPlot
         TGraphErrors* MI_limit = new TGraphErrors(dms_MI.size());   
         TGraphErrors* ST_limit = new TGraphErrors(dms_ST.size());       
         double* XMass = new double[dms_MI.size()];
         double* YUp   = new double[dms_MI.size()];
         double* YDn   = new double[dms_MI.size()];
         for(unsigned int i=0;i<dms_ST.size();i++){
            int MassCut = std::min((int(dms_ST[i][0].mass * 0.6)/100), 5);
            printf("MI %f (%6.2Em) --> %f --> Obs= %E 1SigmaExp=[%E,%E]\n", dms_MI[i][MassCut].mass, log10(299792458 * 6.58211928E-25 / dms_MI[i][MassCut].width), MassCut*100.0, dms_MI[i][MassCut].Limits[5], dms_MI[i][MassCut].Limits[1], dms_MI[i][MassCut].Limits[3]);
            printf("ST %f (%6.2Em) --> %f --> Obs= %E 1SigmaExp=[%E,%E]\n", dms_ST[i][MassCut].mass, log10(299792458 * 6.58211928E-25 / dms_ST[i][MassCut].width), MassCut*100.0, dms_ST[i][MassCut].Limits[5], dms_ST[i][MassCut].Limits[1], dms_ST[i][MassCut].Limits[3]);
            MI_limit->SetPoint(i,  dms_MI[i][MassCut].mass, dms_MI[i][MassCut].Limits[5]);   MI_limit->SetPointError(i, 0, 0);
            ST_limit->SetPoint(i,  dms_ST[i][MassCut].mass, dms_ST[i][MassCut].Limits[5]);   ST_limit->SetPointError(i, 0, 0);
            XMass[i] = dms_MI[i][MassCut].mass; YDn[i] = dms_MI[i][MassCut].Limits[1]; YUp[i] = dms_MI[i][MassCut].Limits[3];
         }
         TCutG* MI_limit1S = GetErrorBand((ModelName + "LimitSigma").Data(), dms_MI.size(), XMass, YDn, YUp, 0.0001, 0.05);
         printf("M = %i  N=%i\n", (int) M, (int) dms_MI.size() );
         MI_limit1S->SetFillColor(kYellow - 7);


         TCanvas* c1 = new TCanvas("c1","c1",600, 600);

/*
         TPaveText* T = new TPaveText(0.0, 0.97, 1.0, 0.99);
         T->SetTextFont(43);  //give the font size in pixel (instead of fraction)
         T->SetTextSize(21);  //font size
         T->SetFillColor(0);
         T->SetTextAlign(22);
         T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");
         T->Draw("same");
*/
         TPad* t1 = new TPad("t1","t1", 0.0, 0.25, 1.0, 1.0);
         t1->Draw();
         t1->cd();
         t1->SetTopMargin(0.06);
         t1->SetBottomMargin(0.13);
         t1->SetLogy(true);

         TH1D* frame = NULL;
         if(M<5){
            frame = new TH1D("frame", "frame; Mass (GeV/c#kern[-0.0]{^{2}})", 1,0,M<2?1100:1100);
            frame->GetXaxis()->SetTitle("Mass (GeV/c#kern[-0.0]{^{2}})");
         }else{
            frame = new TH1D("frame", "frame;log_{10} [ #chi_{1}^{#pm} c#tau (m) ]", 1,-1, 3);
            frame->GetXaxis()->SetTitle("log_{10} [ #chi_{1}^{#pm} c#tau (m) ]");
         }
         frame->SetTitle("");
         frame->SetStats(kFALSE);
         frame->GetYaxis()->SetTitle("Limit on #sigma at 95% C.L.");
         frame->GetXaxis()->SetTitleOffset(1.50);
         frame->GetYaxis()->SetTitleOffset(1.50);
         frame->SetMaximum(0.05);
         frame->SetMinimum(0.0001);
         frame->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetLabelSize(22); //font size
         frame->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetTitleSize(22); //font size
         frame->GetXaxis()->SetNdivisions(510);
         frame->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetLabelSize(22); //font size
         frame->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetTitleSize(22); //font size
         frame->GetYaxis()->SetNdivisions(510);
         frame->Draw("AXIS");

//         MI_limit1S->Draw("f same");


         TGraph* paper = new TGraph(10);
         if(M==0){
            paper->SetPoint(0,100,0.006176);
            paper->SetPoint(1,126,0.004401);
            paper->SetPoint(2,156,0.002385);
            paper->SetPoint(3,200,0.000998);
            paper->SetPoint(4,247,0.000583);
            paper->SetPoint(5,308,0.000353);
            paper->SetPoint(6,370,0.000292);
            paper->SetPoint(7,432,0.000264);
            paper->SetPoint(8,494,0.000252);
            paper->SetPoint(9,557,0.000237);
         }else if(M==1){
            paper->SetPoint(0,100,0.006317);
            paper->SetPoint(1,126,0.004229);
            paper->SetPoint(2,156,0.001741);
            paper->SetPoint(3,200,0.000768);
            paper->SetPoint(4,247,0.000445);
            paper->SetPoint(5,308,0.00029);
            paper->SetPoint(6,370,0.000256);
            paper->SetPoint(7,432,0.000235);
            paper->SetPoint(8,494,0.000231);
            paper->SetPoint(9,557,0.000223);
         }else if (M==2){
            paper->SetPoint(0,100,0.006755);
            paper->SetPoint(1,200,0.001288);
            paper->SetPoint(2,300,0.000328);
            paper->SetPoint(3,400,0.000304);
            paper->SetPoint(4,500,0.00029);
            paper->SetPoint(5,600,0.000292);
            paper->SetPoint(6,700,0.000295);
            paper->SetPoint(7,800,0.000313);
            paper->SetPoint(8,900,0.000329);
            paper->SetPoint(9,1000,0.000356);
         }

         if(ThXSecErr!=NULL){
            ThXSec->SetLineColor(8);   ThXSec->SetLineWidth(2); ThXSec->Draw("L");
            ThXSecErr->Draw("f same");
         }


         TGraphErrors* A = ST_limit;
         TGraphErrors* B = MI_limit;
         TGraphErrors* R = MakeGraphRatio(B,A);
         B->SetLineColor(4);   B->SetLineWidth(2); B->SetMarkerColor(4);  B->SetMarkerStyle(8);  B->SetFillColor(0); B->Draw("same LP0");
         A->SetLineColor(2);   A->SetLineWidth(2); A->SetMarkerColor(2);  A->SetMarkerStyle(4);  A->SetFillColor(0); A->Draw("same LP0");
         R->SetLineColor(4);   R->SetMarkerColor(4);  R->SetMarkerStyle(8);
         paper->SetLineColor(1); paper->SetLineWidth(2);
         if(M<=2)paper->Draw("same L");

      //   TLegend* leg = new TLegend(0.5,0.13,0.88,0.30);
         TLegend* leg = new TLegend(0.39,0.92,0.88,0.92-5*0.075);
         leg->SetFillStyle(0);
         leg->SetBorderSize(0);
         leg->SetTextFont(43);
         leg->SetTextSize(23);
         leg->SetHeader(LegendName);
         if(M<=2)leg->AddEntry(paper, "EXO-12-026", "L");
         leg->AddEntry(A, "Obs. Full Simulation" ,"PL");
         leg->AddEntry(B, "Obs. Fast Technique" ,"PL");
//         leg->AddEntry(MI_limit1S, "Exp. #pm1 #sigma unc." ,"F");
         if(ThXSecErr!=NULL){leg->AddEntry(ThXSecErr, "Theoretical Prediction", "F");}
         leg->Draw();

         c1->cd();
         TPad* t2 = new TPad("t2","t2", 0.0, 0.0, 1.0, 0.25);
         t2->Draw();
         t2->cd();
         t2->SetLogy(false);
         t2->SetGridx(true);
         t2->SetGridy(true);
         t2->SetTopMargin(0.04);
         t2->SetBottomMargin(0.14);

         TH1D* frameR = NULL;
         if(M<5){
            frameR = new TH1D("frameR", "frameR", 1,0,M<2?1100:1100);
         }else{
            frameR = new TH1D("frameR", "frameR", 1,-1, 3);
         }
         frameR->SetTitle("");
         frameR->SetStats(kFALSE);
         frameR->GetXaxis()->SetTitleOffset(1.50);
         frameR->GetYaxis()->SetTitle("Ratio");
         frameR->GetYaxis()->SetTitleOffset(1.50);
         frameR->SetMaximum(1.30);   
         frameR->SetMinimum(0.70);
         frameR->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetLabelSize(22); //font size
         frameR->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetTitleSize(22); //font size
         frameR->GetXaxis()->SetNdivisions(510);
         frameR->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetLabelSize(22); //font size
         frameR->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetTitleSize(22); //font size
         frameR->GetYaxis()->SetNdivisions(510);
         frameR->Draw("AXIS");

         TLine* LineAt10 = new TLine(0,1.0,1100,1.0);      LineAt10->SetLineStyle(1);   LineAt10->Draw();
         TLine* LineAt11 = new TLine(0,1.1,1100,1.1);      LineAt11->SetLineStyle(2);   LineAt11->Draw();
         TLine* LineAt12 = new TLine(0,1.2,1100,1.2);      LineAt12->SetLineStyle(2);   LineAt12->Draw();
         TLine* LineAt09 = new TLine(0,0.9,1100,0.9);      LineAt09->SetLineStyle(2);   LineAt09->Draw();
         TLine* LineAt08 = new TLine(0,0.8,1100,0.8);      LineAt08->SetLineStyle(2);   LineAt08->Draw();
         R->Draw("same P2");

         c1->cd();

         TPaveText* T1 = new TPaveText(0.50, 0.95, 0.88, 1.0);
         T1->SetTextFont(43); T1->SetTextSize(23);   T1->SetTextAlign(32);
         T1->SetFillColor(0); T1->SetFillStyle(0);   T1->SetBorderSize(0);
         T1->AddText("18.8 fb^{-1} (8 TeV)");
         T1->Draw("same");

         TPaveText* T2 = new TPaveText(0.14, 0.89, 0.85, 0.94);
         T2->SetTextFont(63); T2->SetTextSize(30);   T2->SetTextAlign(12);
         T2->SetFillColor(0); T2->SetFillStyle(0);   T2->SetBorderSize(0);
         T2->AddText("CMS");
         T2->Draw("same");

         TPaveText* T3 = new TPaveText(0.14, 0.84, 0.85, 0.89);
         T3->SetTextFont(53); T3->SetTextSize(23);   T3->SetTextAlign(12);
         T3->SetFillColor(0); T3->SetFillStyle(0);   T3->SetBorderSize(0);
         T3->AddText("Unpublished");


         char saveName[256]; 
         sprintf(saveName,"pictures/CompPlot_%s_Limit.png", ModelName.Data());  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_Limit.C"  , ModelName.Data());  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_Limit.pdf", ModelName.Data());  c1->SaveAs(saveName);


//         T->Clear(); 
//         T->AddText("CMS (unpublished)  -  #sqrt{s} = 8 TeV  -   L = 18.8 fb^{-1}");
         T3->Draw("same");
         sprintf(saveName,"pictures/CompPlot_%s_Limit_Unpublished.png", ModelName.Data());  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_Limit_Unpublished.pdf", ModelName.Data());  c1->SaveAs(saveName);

//         delete c1; delete frame; delete frameR;
      } 

   }

/////////////////////////////////////////////////  PLOT OF PROC EFFICIENCY

   string binlabel[]     = {"#chi_{1}^{+} #chi_{1}^{-}", "#tilde{g}#tilde{g}#rightarrow tt/bb", "#tilde{g}#tilde{g}#rightarrow qq", "#tilde{q}#tilde{q}" };
   string pMSSMINC2[] = {"pMSSM_8TeV_M200", "pMSSM12_MCMC1_30_549144_sgsgToChipmsq_m200", "pMSSM12_MCMC1_30_549144_sgsgToChipmtb_m200", "pMSSM12_MCMC1_30_549144_sqsq_m200"};
   string pMSSMINC7[] = {"pMSSM_8TeV_M700", "pMSSM12_MCMC1_30_549144_sgsgToChipmsq_m700", "pMSSM12_MCMC1_30_549144_sgsgToChipmtb_m700", "pMSSM12_MCMC1_30_549144_sqsq_m700"};
   std::vector< std::vector<dataModel> > dms_pMSSMInc2_ST;
   std::vector< std::vector<dataModel> > dms_pMSSMInc2_MI;
   std::vector< std::vector<dataModel> > dms_pMSSMInc2_MINoIso;
   std::vector< std::vector<dataModel> > dms_pMSSMInc7_ST;
   std::vector< std::vector<dataModel> > dms_pMSSMInc7_MI;
   std::vector< std::vector<dataModel> > dms_pMSSMInc7_MINoIso;
   for(int n=0;n<4;n++){
      dms_pMSSMInc2_ST.push_back(readFromFile(string("pictures/Std_") + pMSSMINC2[n] + ".txt", 200.0 + n+0.5));
      dms_pMSSMInc2_MI.push_back(readFromFile(string("pictures/MI_" ) + pMSSMINC2[n] + ".txt", 200.0 + n+0.5));
      dms_pMSSMInc2_MINoIso.push_back(readFromFile(string("../ModelIndependent/pictures/MI_" ) + pMSSMINC2[n] + ".txt", 200.0 + n+0.5));
      dms_pMSSMInc7_ST.push_back(readFromFile(string("pictures/Std_") + pMSSMINC7[n] + ".txt", 700.0 + n+0.5));
      dms_pMSSMInc7_MI.push_back(readFromFile(string("pictures/MI_" ) + pMSSMINC7[n] + ".txt", 700.0 + n+0.5));
      dms_pMSSMInc7_MINoIso.push_back(readFromFile(string("../ModelIndependent/pictures/MI_" ) + pMSSMINC7[n] + ".txt", 700.0 + n+0.5));
   }

   for(unsigned int M=0;M<2;M++){
      TString ModelName, LegendName;
      std::vector< std::vector<dataModel> > dms_ST;
      std::vector< std::vector<dataModel> > dms_MI;
      std::vector< std::vector<dataModel> > dms_MINoIso;
      int LevelIndex= 0;

      double Xmin =0;
      double Xmax = 1100;
      switch(M){
         case 0:
            ModelName = "pMSSMInc2";             LegendName="#chi_{1}^{#pm} (Stable, M = 200GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMInc2_ST;
            dms_MI = dms_pMSSMInc2_MI;
            dms_MINoIso = dms_pMSSMInc2_MINoIso;
            LevelIndex = 1;   Xmin=200; Xmax=204;
            dms_MI[3][1].OEff *= 0.67;//dirty trick
            break;

         case 1:
            ModelName = "pMSSMInc7";             LegendName="#chi_{1}^{#pm} (Stable, M = 700GeV/c#kern[-0.0]{^{2}})";
            dms_ST = dms_pMSSMInc7_ST;
            dms_MI = dms_pMSSMInc7_MI;
            dms_MINoIso = dms_pMSSMInc7_MINoIso;
            LevelIndex = 3;   Xmin=700; Xmax=704;
            break;
      } 

         TCanvas* c1 = new TCanvas("c1","c1",600, 600);

//         TPaveText* T = new TPaveText(0.0, 0.97, 1.0, 0.99);
//         T->SetTextFont(43);  //give the font size in pixel (instead of fraction)
//         T->SetTextSize(21);  //font size
//         T->SetFillColor(0);
//         T->SetTextAlign(22);
//         T->AddText("CMS Preliminary  -  #sqrt{s} = 8 TeV  -  Simulation");
//         T->Draw("same");

         TPad* t1 = new TPad("t1","t1", 0.0, 0.25, 1.0, 1.0);
         t1->Draw();
         t1->cd();
         t1->SetTopMargin(0.06);
         t1->SetBottomMargin(0.13);

         TH1D* frame = NULL;
         frame = new TH1D("frame", "frame; Mass (GeV/c#kern[-0.0]{^{2}})", 4,Xmin, Xmax);
         frame->GetXaxis()->SetTitle(" ");
         frame->SetTitle("");
         frame->SetStats(kFALSE);
         frame->GetXaxis()->SetTitleOffset(1.50);
         frame->GetYaxis()->SetTitleOffset(1.50);
         frame->SetMaximum(100);
         frame->SetMinimum(0);
         frame->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetLabelSize(22); //font size
         frame->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetXaxis()->SetTitleSize(22); //font size
         frame->GetXaxis()->SetNdivisions(510);
         frame->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetLabelSize(22); //font size
         frame->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frame->GetYaxis()->SetTitleSize(22); //font size
         frame->GetYaxis()->SetNdivisions(510);
         frame->Draw("AXIS");

         TGraphErrors* A = MakePlot(LevelIndex, dms_ST);
         TGraphErrors* B = MakePlot(LevelIndex, dms_MI);
         TGraphErrors* C = MakePlot(LevelIndex, dms_MINoIso);
         TGraphErrors* R = MakeGraphRatio(B,A);
         TGraphErrors* S = MakeGraphRatio(C,A);
         frame->GetYaxis()->SetTitle(A->GetYaxis()->GetTitle());
         frame->SetMaximum( 1.10*std::max(A->GetMaximum(), B->GetMaximum()));
         for(int n=0;n<sizeof(binlabel)/sizeof(string);n++){ frame->GetXaxis()->SetBinLabel(1+n, binlabel[n].c_str()); }
         C->SetLineColor(8);   C->SetMarkerColor(8);  C->SetMarkerStyle(21); C->SetFillColor(0); C->Draw("same P0");  C->SetMarkerSize(1.2);
         B->SetLineColor(4);   B->SetMarkerColor(4);  B->SetMarkerStyle(8);  B->SetFillColor(0); B->Draw("same P0");
         A->SetLineColor(2);   A->SetMarkerColor(2);  A->SetMarkerStyle(4);  A->SetFillColor(0); A->Draw("same P0");
         R->SetLineColor(4);   R->SetMarkerColor(4);  R->SetMarkerStyle(8);  
         S->SetLineColor(8);   S->SetMarkerColor(8);  S->SetMarkerStyle(21); S->SetMarkerSize(1.2);


         frame->SetMaximum(75);
         frame->SetMinimum(0);


      //   TLegend* leg = new TLegend(0.5,0.13,0.88,0.30);
         TLegend* leg = NULL;
         if(M==0){leg=new TLegend(0.33,0.90-4*0.075,0.85,0.90);}else{leg = new TLegend(0.33,0.20,0.85,0.20+4*0.075);}
         leg->SetFillStyle(0);
         leg->SetBorderSize(0);
         leg->SetTextFont(43);
         leg->SetTextSize(23);
         leg->SetHeader(LegendName);
         leg->AddEntry(A, "Full Simulation" ,"P");
         leg->AddEntry(C, "Fast Technique (w/o iso)" ,"P");
         leg->AddEntry(B, "Fast Technique (w/  iso)" ,"P");
         leg->Draw();

         c1->cd();
         TPad* t2 = new TPad("t2","t2", 0.0, 0.0, 1.0, 0.25);
         t2->Draw();
         t2->cd();
         t2->SetGridx(true);
         t2->SetGridy(true);
         t2->SetTopMargin(0.04);
         t2->SetBottomMargin(0.14);

         TH1D* frameR = NULL;
         frameR = new TH1D("frameR", "frameR", 4,Xmin, Xmax);
         frameR->SetTitle("");
         frameR->SetStats(kFALSE);
         frameR->GetXaxis()->SetTitleOffset(1.50);
         frameR->GetYaxis()->SetTitle("Ratio");
         frameR->GetYaxis()->SetTitleOffset(1.50);
         frameR->SetMaximum(1.30);   
         frameR->SetMinimum(0.70);
         frameR->GetXaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetLabelSize(22); //font size
         frameR->GetXaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetXaxis()->SetTitleSize(22); //font size
         frameR->GetXaxis()->SetNdivisions(510);
         frameR->GetYaxis()->SetLabelFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetLabelSize(22); //font size
         frameR->GetYaxis()->SetTitleFont(43); //give the font size in pixel (instead of fraction)
         frameR->GetYaxis()->SetTitleSize(22); //font size
         frameR->GetYaxis()->SetNdivisions(510);
         frameR->Draw("AXIS");
         for(int n=0;n<sizeof(binlabel)/sizeof(string);n++){ frameR->GetXaxis()->SetBinLabel(1+n, " "); }

         TLine* LineAt10 = new TLine(Xmin,1.0,Xmax,1.0);      LineAt10->SetLineStyle(1);   LineAt10->Draw();
         TLine* LineAt11 = new TLine(Xmin,1.1,Xmax,1.1);      LineAt11->SetLineStyle(2);   LineAt11->Draw();
         TLine* LineAt12 = new TLine(Xmin,1.2,Xmax,1.2);      LineAt12->SetLineStyle(2);   LineAt12->Draw();
         TLine* LineAt09 = new TLine(Xmin,0.9,Xmax,0.9);      LineAt09->SetLineStyle(2);   LineAt09->Draw();
         TLine* LineAt08 = new TLine(Xmin,0.8,Xmax,0.8);      LineAt08->SetLineStyle(2);   LineAt08->Draw();
         S->Draw("same P2");
         R->Draw("same P2");

         c1->cd();
         TPaveText* T1 = new TPaveText(0.50, 0.95, 0.88, 1.0);
         T1->SetTextFont(43); T1->SetTextSize(23);   T1->SetTextAlign(32);
         T1->SetFillColor(0); T1->SetFillStyle(0);   T1->SetBorderSize(0);
         T1->AddText("Simulation (8 TeV)");
         T1->Draw("same");

         TPaveText* T2 = new TPaveText(0.14, 0.89, 0.85, 0.94);
         T2->SetTextFont(63); T2->SetTextSize(30);   T2->SetTextAlign(12);
         T2->SetFillColor(0); T2->SetFillStyle(0);   T2->SetBorderSize(0);
         T2->AddText("CMS");
         T2->Draw("same");

         TPaveText* T3 = new TPaveText(0.14, 0.84, 0.85, 0.89);
         T3->SetTextFont(53); T3->SetTextSize(23);   T3->SetTextAlign(12);
         T3->SetFillColor(0); T3->SetFillStyle(0);   T3->SetBorderSize(0);
         T3->AddText("Unpublished");

         char saveName[256]; 
         sprintf(saveName,"pictures/CompPlot_%s_%i.png", ModelName.Data(), LevelIndex);  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i.C"  , ModelName.Data(), LevelIndex);  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i.pdf", ModelName.Data(), LevelIndex);  c1->SaveAs(saveName);


//         T->Clear();
//         T->AddText("CMS (unpublished)  -  #sqrt{s} = 8 TeV  -  Simulation");
         T3->Draw("same");
         sprintf(saveName,"pictures/CompPlot_%s_%i_Unpublished.png", ModelName.Data(), LevelIndex);  c1->SaveAs(saveName);
         sprintf(saveName,"pictures/CompPlot_%s_%i_Unpublished.pdf", ModelName.Data(), LevelIndex);  c1->SaveAs(saveName);
         delete c1; delete frame; delete frameR;
      }
}


